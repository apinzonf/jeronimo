#LyX 2.1 created this file. For more info see http://www.lyx.org/
\lyxformat 474
\begin_document
\begin_header
\textclass scrbook
\begin_preamble
%\documentclass[12pt,spanish,fleqn,openany,letterpaper,pagesize]{scrbook}

%\usepackage[ansinew]{inputenc}
%\usepackage[spanish]{babel}
\usepackage{fancyhdr}
\usepackage{epsfig}
\usepackage{epic}
\usepackage{eepic}
\usepackage{amsmath}
\usepackage{threeparttable}
\usepackage{amscd}
\usepackage{here}
\usepackage{graphicx}
\usepackage{lscape}
\usepackage{tabularx}
\usepackage{subfigure}
\usepackage{longtable}


\usepackage{rotating} %Para rotar texto, objetos y tablas seite. No se ve en DVI solo en PS. Seite 328 Hundebuch
                        %se usa junto con \rotate, \sidewidestable ....


\renewcommand{\theequation}{\thechapter-\arabic{equation}}
\renewcommand{\thefigure}{\textbf{\thechapter-\arabic{figure}}}
\renewcommand{\thetable}{\textbf{\thechapter-\arabic{table}}}


\pagestyle{fancyplain}%\addtolength{\headwidth}{\marginparwidth}
\textheight22.5cm \topmargin0cm \textwidth16.5cm
\oddsidemargin0.5cm \evensidemargin-0.5cm%
\renewcommand{\chaptermark}[1]{\markboth{\thechapter\; #1}{}}
\renewcommand{\sectionmark}[1]{\markright{\thesection\; #1}}
\lhead[\fancyplain{}{\thepage}]{\fancyplain{}{\rightmark}}
\rhead[\fancyplain{}{\leftmark}]{\fancyplain{}{\thepage}}
\fancyfoot{}
\thispagestyle{fancy}%


\addtolength{\headwidth}{0cm}
\unitlength1mm %Define la unidad LE para Figuras
%\mathindent0cm %Define la distancia de las formulas al texto,  fleqn las descentra
\marginparwidth0cm
\parindent0cm %Define la distancia de la primera linea de un parrafo a la margen

%Para tablas,  redefine el backschlash en tablas donde se define la posici\'{o}n del texto en las
%casillas (con \centering \raggedright o \raggedleft)
\newcommand{\PreserveBackslash}[1]{\let\temp=\\#1\let\\=\temp}
\let\PBS=\PreserveBackslash

%Espacio entre lineas
\renewcommand{\baselinestretch}{1.1}

%Neuer Befehl f\"{u}r die Tabelle Eigenschaften der Aktivkohlen
\newcommand{\arr}[1]{\raisebox{1.5ex}[0cm][0cm]{#1}}

%Neue Kommandos
\usepackage{resources/Befehle}


%Trennungsliste
\hyphenation {Reaktor-ab-me-ssun-gen Gas-zu-sa-mmen-set-zung
Raum-gesch-win-dig-keit Durch-fluss Stick-stoff-gemisch
Ad-sorp-tions-tem-pe-ra-tur Klein-schmidt
Kohlen-stoff-Mole-kular-siebe Py-rolysat-aus-beu-te
Trans-port-vor-gan-ge}

%\pagenumbering{roman}
%\let\myTOC\tableofcontents
%\renewcommand\tableofcontents{%
%\myTOC
%\clearpage
%\pagenumbering{arabic}
%}
\end_preamble
\options 12pt,english,openany,letterpaper,pagesize
\use_default_options true
\begin_modules
theorems-ams
\end_modules
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman default
\font_sans default
\font_typewriter default
\font_math auto
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100
\font_tt_scale 100
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize 12
\spacing onehalf
\use_hyperref false
\papersize letterpaper
\use_geometry false
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 0
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 0
\use_package mhchem 1
\use_package stackrel 0
\use_package stmaryrd 0
\use_package undertilde 0
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 0
\index Índice
\shortcut idx
\color #008000
\end_index
\secnumdepth 2
\tocdepth 2
\paragraph_separation skip
\defskip medskip
\quotes_language english
\papercolumns 1
\papersides 2
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
pagenumbering{roman}
\end_layout

\begin_layout Plain Layout


\backslash
begin{center}
\end_layout

\begin_layout Plain Layout


\backslash
begin{figure}
\end_layout

\begin_layout Plain Layout


\backslash
centering%
\end_layout

\begin_layout Plain Layout


\backslash
includegraphics[width=0.4
\backslash
columnwidth]{resources/logo_un.png}
\end_layout

\begin_layout Plain Layout

%
\backslash
includegraphics[width=0.4]{logo_un.png}
\end_layout

\begin_layout Plain Layout


\backslash
end{figure}
\end_layout

\begin_layout Plain Layout


\backslash
thispagestyle{empty}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset VSpace 2cm
\end_inset


\end_layout

\begin_layout Standard

\series bold
\size huge
An Adapted Laplacian Operator For Hybrid Quad/Triangle Meshes
\end_layout

\begin_layout Standard
\begin_inset VSpace 6cm
\end_inset


\end_layout

\begin_layout Standard

\series bold
\size large
Alexander Pinzón Fernández
\end_layout

\begin_layout Standard
\begin_inset VSpace 6cm
\end_inset


\end_layout

\begin_layout Standard
Universidad Nacional de Colombia
\end_layout

\begin_layout Standard
Facultad de Ingeniería, Departamento de Ingeniería de Sistemas e Industrial
\end_layout

\begin_layout Standard

\size small
Grupo de Investigación CIM@LAB
\end_layout

\begin_layout Standard
Bogotá, Colombia
\end_layout

\begin_layout Standard
2014
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{center}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{center}
\end_layout

\begin_layout Plain Layout


\backslash
thispagestyle{empty} 
\end_layout

\begin_layout Plain Layout


\backslash
vspace*{0cm} 
\end_layout

\end_inset


\end_layout

\begin_layout Standard

\series bold
\size huge
An Adapted Laplacian Operator For Hybrid Quad/Triangle Meshes
\end_layout

\begin_layout Standard
\begin_inset VSpace 2.5cm
\end_inset


\end_layout

\begin_layout Standard

\series bold
\size large
Alexander Pinzón Fernández
\end_layout

\begin_layout Standard
\begin_inset VSpace 2.5cm
\end_inset


\end_layout

\begin_layout Standard

\size small
A thesis submitted in partial fulfillment of the requirements for the degree
 of:
\end_layout

\begin_layout Standard

\series bold
Master in Systems Engineering and Computer Science
\end_layout

\begin_layout Standard
\begin_inset VSpace 2cm
\end_inset


\end_layout

\begin_layout Standard

\size small
Advisor:
\begin_inset Newline newline
\end_inset

Eduardo Romero Castro , Ph.D.
\end_layout

\begin_layout Standard

\size small
\begin_inset VSpace 1.5cm
\end_inset


\end_layout

\begin_layout Standard

\size small
Research Area:
\begin_inset Newline newline
\end_inset

Computer Graphics
\end_layout

\begin_layout Standard

\size small
\begin_inset VSpace 2cm
\end_inset


\end_layout

\begin_layout Standard

\size small
Universidad Nacional de Colombia
\begin_inset Newline newline
\end_inset

Facultad de Ingeniería, Departamento de Sistemas e Industrial
\begin_inset Newline newline
\end_inset

Grupo de Investigación CIM@LAB
\begin_inset Newline newline
\end_inset

Bogotá, Colombia
\begin_inset Newline newline
\end_inset

2014
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{center}
\end_layout

\begin_layout Plain Layout


\backslash
newpage 
\end_layout

\begin_layout Plain Layout


\backslash
thispagestyle{empty}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

\series bold
Dedicación
\end_layout

\begin_layout Standard

\size small
\begin_inset VSpace 4cm
\end_inset


\end_layout

\begin_layout Standard
\noindent
\align right
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "8cm"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout

\size small
A Beatriz y Campo Elias mis padres que siempre me dieron la libertad de
 escoger, con su comprensión y apoyo me permitieron dedicar mi tiempo a
 la ciencia.
\end_layout

\begin_layout Plain Layout

\size small
\begin_inset VSpace 1cm
\end_inset


\end_layout

\begin_layout Plain Layout

\size small
A mis padres
\end_layout

\begin_layout Plain Layout

\size small
\begin_inset VSpace 1cm
\end_inset


\end_layout

\begin_layout Plain Layout
Beatriz Fernandez Vargas
\end_layout

\begin_layout Plain Layout
Campo Elias Pinzón Rojas
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
newpage
\end_layout

\begin_layout Plain Layout


\backslash
thispagestyle{empty}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

\series bold
\size largest
Acknowledgment
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
addcontentsline{toc}{chapter}{
\backslash
protect
\backslash
numberline{}Acknowledgement}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset VSpace 2cm
\end_inset


\end_layout

\begin_layout Standard
I would like to thank my advisor professor Eduardo Romero and the CIM&LAB
 research group for their support in this thesis.
 
\end_layout

\begin_layout Standard

\size small
\begin_inset VSpace 1cm
\end_inset


\end_layout

\begin_layout Standard
I would like to thank all the workers in Colombia who fund public education
 with their work.
\end_layout

\begin_layout Standard

\size small
\begin_inset VSpace 1cm
\end_inset


\end_layout

\begin_layout Standard
This work was supported in part by the Blender Foundation and the Google
 Summer of Code program 2012 and 2013.
 
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Standard

\series bold
\size largest
Abstract
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
addcontentsline{toc}{chapter}{
\backslash
protect
\backslash
numberline{}Abstract}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
In the last two decades three-dimensional modeling methods used by artists
 have been evolving and developing rapidly thanks to the use of vector operators
 of differential geometry such as the Laplacian operator.
 This operator allows modeling the behavior of complex applications such
 as noise reduction, enhancement, remeshing, UV mapping, posing and skeletonizat
ion, among others, in a simple way.
 The Laplacian operator is theoretically defined in a continuous and smooth
 domain, named manifold.
 In practice manifolds are often approximated by discrete polygon meshes
 composed by triangles and quadrangles which represent the real world three-dime
nsional objects with which the artists work.
 In these meshes, spectral structure is calculated using a discrete Laplacian
 operator, i.e.
 the discrete version of the Laplacian operator given by Pinkall in 1993.
 This approach only worked with triangle meshes.
 In 2011 Xiong extended the operator to work exclusively with quad meshes.
 This thesis proposes an original extension of the Laplacian operator that
 allows working with hybrid meshes composed by triangles and quadrangles.
\end_layout

\begin_layout Standard
Along with the operator, this work presents new sculpting and modeling applicati
ons based on enhancement.
 Additionally, applications on subdivision surfaces which use smoothing,
 mesh posing which use differential coordinates and skeletonization which
 use iterative contractions are developed.
 This series of applications demonstrates the quality, predictability and
 flexibility of the proposed operator.
\end_layout

\begin_layout Standard
The proposed operator was successfully used in new software tools in real
 production environment within 3D computer graphics software Blender.
 Currently these tools are available as open source software.
 
\end_layout

\begin_layout Standard

\series bold
\size largest
Resumen
\end_layout

\begin_layout Standard
En las dos últimas décadas los métodos de modelado tridimensional utilizadas
 por los artistas han ido evolucionando y desarrollándose rápidamente, en
 parte gracias al uso de operadores vectoriales de geometría diferencial,
 como el operador de Laplace.
 Este operador permite modelar de una manera sencilla el comportamiento
 de aplicaciones complejas tales como la reducción de ruido, realce, remallado,
 mapeado UV, posado y esqueletonización, entre otros.
 Este operador Laplaciano es teóricamente definido en un dominio continuo
 y suave llamado variedad, las variedades son a menudo aproximadas por mallas
 discretas de polígonos compuestas por triángulos y cuadrángulos que a su
 vez representan objetos tridimensionales del mundo real que los artistas
 trabajan.
 En estas mallas se calcula la estructura espectral con el uso de algún
 operador Laplaciano discreto, la versión discreta del operador Laplaciano
 propuesta por Pinkall en el 1993 trabaja únicamente con mallas compuestas
 por triángulos, y la de Xiong en el 2011 trabaja exclusivamente con cuadrángulo
s.
 Esta tesis propone una extensión original del Operador Laplaciano que permite
 trabajar con mallas híbridas compuestas por triángulos y cuadrángulos.
\end_layout

\begin_layout Standard
Junto con el operador, este trabajo presenta nuevas aplicaciones en esculpido
 y modelamiento con base en el realce, aplicaciones en subdivisión de superficie
s con el uso de suavizado, posado de mallas con el uso de coordenadas diferencia
les y esqueletonización usando contracción iterativa.
 Esta serie de aplicaciones demuestra la calidad, predictibilidad y flexibilidad
 del operador propuesto.
\end_layout

\begin_layout Standard
El operador propuesto fue usado con exitoso en las nuevas herramientas del
 software para gráficos 3D por computadora Blender.
 Actualmente estas herramientas están disponibles como programas de código
 abierto.
 
\end_layout

\begin_layout Standard

\size small
\begin_inset VSpace 1cm
\end_inset


\end_layout

\begin_layout Standard

\series bold
\size small
Keywords: laplacian operator; smooth; enhance; sculpting; subdivision surface
\end_layout

\begin_layout Standard
\begin_inset CommandInset toc
LatexCommand tableofcontents

\end_inset


\end_layout

\begin_layout Standard
\begin_inset FloatList figure

\end_inset


\end_layout

\begin_layout Standard
\begin_inset FloatList table

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
pagenumbering{arabic}
\end_layout

\end_inset


\end_layout

\begin_layout Chapter
Introduction
\end_layout

\begin_layout Standard
The discrete versions of the Laplace Beltrami Operator have been used in
 recent years for the development of new geometric modeling tools.
 Pinkall 
\begin_inset CommandInset citation
LatexCommand cite
key "Pinkall1993"

\end_inset

 introduced the cotangent version of the Laplace operator, which allowed
 finding the minimal surface when computing a discrete harmonic map with
 the Laplacian operator.
 This version has been widely studied and applied in various problems of
 computer geometric modeling.
 This type of operator was defined over manifolds, i.e.
 continuous domains homeomorphic to 
\begin_inset Formula $\mathbb{R}^{n}$
\end_inset

 that are represented in pratice by polygon meshes.
 These polygons are generally composed of triangles and quadrangles.
 Working with the Laplacian operator in this hybrid composition is not a
 mathematical challenge, most research only uses meshes composed by triangles
 
\begin_inset CommandInset citation
LatexCommand cite
key "Pinkall1993,Desbrun1999,Meyer2003,Sorkine2004,Au2008,Belkin2008,Hahne2006"

\end_inset

.
 In recent studies 
\begin_inset CommandInset citation
LatexCommand cite
key "Liu2008,Xiong2011"

\end_inset

, the Laplacian operator may be used in meshes composed exclusively by quadrangl
es.
 However, from an artistic point of view, the topology and the way the edges,
 triangles and quadrangles are distributed, directly affects the processes
 of animation, interpolation, texturing, etc., as discussed by 
\begin_inset CommandInset citation
LatexCommand cite
key "Mullen2007"

\end_inset

, who uses a manual connection of a pair of vertices to perform animation
 processes and interpolation.
 It is then of paramount importance to develop operators that easily interact
 with such meshes, eliminating the need of preprocessing the mesh to convert
 it to triangles and change the original topology.
 
\end_layout

\begin_layout Standard
Presently, modeling techniques that are able to generate a variety of realistic
 shapes are available 
\begin_inset CommandInset citation
LatexCommand cite
key "Botsch2006"

\end_inset

 .
 Editing techniques have evolved from affine transformations to advanced
 tools such as sculpting 
\begin_inset CommandInset citation
LatexCommand cite
key "Coquillart1990,Galyean1991,Stanculescu2011"

\end_inset

, editing, creation from sketches 
\begin_inset CommandInset citation
LatexCommand cite
key "Igarashi1999,Gonen2012"

\end_inset

, and complex interpolation techniques 
\begin_inset CommandInset citation
LatexCommand cite
key "Sorkine2004,Zhou2005"

\end_inset

.
 Catmull-Clark based methods however require interaction with a minimum
 number of control points for any operation to be efficient, or in other
 words, a unicity condition is introduced by demanding a smooth surface
 after any of these shape operations.
 Hence, traditional modeling methods for subdividing surfaces from coarse
 geometry have become widely popular 
\begin_inset CommandInset citation
LatexCommand cite
key "Catmull1978,Stam1998"

\end_inset

.
 These works have generalized a uniform B-cubic spline knot insertion to
 meshes.
 Some of these add some type of control; for instance with the use of creases
 to produce sharp edges 
\begin_inset CommandInset citation
LatexCommand cite
key "DeRose1998"

\end_inset

 or the modification of some vertex weights to locally control the zone
 of influence 
\begin_inset CommandInset citation
LatexCommand cite
key "Biermann2000"

\end_inset

.
 Nevertheless, these methods are difficult to use as they require a large
 number of parameters and a very tedious customization.
 
\end_layout

\begin_layout Standard
On the other hand, the proposed applications require a single parameter
 that controls the global curvature, which is used to maintain realistic
 shapes, creating a family of different versions of the same object and
 therefore preserving the detail of the original model and a realistic appearanc
e.
 
\end_layout

\begin_layout Standard
The shape inflation and shape exaggeration can thus be used as a type of
 brush in the sculpting process.
 When inflating a shape with other brushes the former ends up losing detail
 when moving vertices 
\begin_inset CommandInset citation
LatexCommand cite
key "Stanculescu2011"

\end_inset

.
 In contrast, the presented enhance method inflates a mesh by moving the
 vertices towards the reverse curvature direction, conserving the shape
 and sharp features of the model.
\end_layout

\begin_layout Paragraph
Contributions
\end_layout

\begin_layout Standard
This work presents an extension of the Laplace Beltrami Operator for hybrid
 quad/triangle meshes that have a larger mesh functionality spectrum than
 common triangular or quadrangular meshes.
 The method eliminates the need of preprocessing and allows preservation
 of the original topology.
 Along with this operator, we propose a method to generate a family of parameter
ized shapes, in a robust and predictable way.
 This method enables customization of the smoothness and curvature obtained
 during the subdivision surfaces process.
 Finally, a new brush for inflating the silhouette mesh features in modeling
 and sculpting is proposed.
\end_layout

\begin_layout Standard
The work is organized as follows: chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Mathematical-foundation"

\end_inset

 presents works related to the Laplacian operator, applications in digital
 sculpting, deformation, and offsetting methods for polygonal meshes.
 It also describes the theoretical framework of the Laplacian operator for
 polygon meshes; in chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "chap:SibgrapiPaper"

\end_inset

, we show the extension of the Laplacian Operator for hybrid meshes and
 the applications of shape inflation ,subdivision of surfaces and sculpting;
 in chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Laplacian-Smooth"

\end_inset

, we present an application for mesh smoothing of the Laplacian operator
 extension here proposed, and implemented into a well known software for
 computer modelling.
 Finally, in chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Laplacian-Deform"

\end_inset

, we present a successful application for mesh deformation and model re-posing
 based on differential coordinates and the adaptation of this method to
 work with our Laplacian operator extension.
\end_layout

\begin_layout Chapter
Mathematical Foundation and Background
\begin_inset CommandInset label
LatexCommand label
name "chap:Mathematical-foundation"

\end_inset


\end_layout

\begin_layout Standard
This chapter studies basic mathematical foundations on differential geometry
 to understand the differential operators and the Laplace Beltrami operator.
\end_layout

\begin_layout Standard
The differential geometry studies curvatures and geodesics 
\begin_inset CommandInset citation
LatexCommand cite
key "Hahne2006"

\end_inset

.
 These differential operators show a deep relationship between the geometry
 (curvatures, geodesics) and topology of the manifold.
 They have been commonly used in computer geometric modeling applications
 over recent years 
\begin_inset CommandInset citation
LatexCommand cite
key "Rosenberg1997,Alexa2011"

\end_inset

.
\end_layout

\begin_layout Section
Related work
\end_layout

\begin_layout Standard
Many tools, based on the Laplacian mesh processing, have been developed
 for modeling.
 These tools preserve the surface geometric details when using Laplacian
 operators for different processes such as smoothing, enhancing, free-form
 deformation, fusion, morphing and other applications 
\begin_inset CommandInset citation
LatexCommand cite
key "Ranjan2012"

\end_inset

.
 
\end_layout

\begin_layout Standard
The most used discretization of Laplace Beltrami operator 
\begin_inset Formula $\Delta_{\mbox{\Omega}}$
\end_inset

 over a triangulated mesh 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $\Omega$
\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
 was proposed by Pinkall 
\begin_inset CommandInset citation
LatexCommand cite
key "Pinkall1993"

\end_inset

.
 
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Formula $\Delta_{\mbox{\Omega}}\left(u\right)=\frac{1}{2}\sum_{j\in N_{1}\left(i\right)}\left(\cot\alpha_{j}+\cot\beta_{j}\right)\left(x_{i}-x_{j}\right)$
\end_inset


\end_layout

\begin_layout Standard
Where 
\begin_inset Formula $N_{1}$
\end_inset

is the 1-ring neighborhood, 
\begin_inset Formula $\alpha$
\end_inset

 and 
\begin_inset Formula $\beta$
\end_inset

 are the opposite angles to edge between vertex 
\begin_inset Formula $i$
\end_inset

 and vertex 
\begin_inset Formula $j$
\end_inset

.
 In this work the discrete Laplacian operator is used to find the minimal
 surface based on energy minimization strategy using the Dirichlet's energy
 of the function 
\begin_inset Formula $u$
\end_inset

 over a manifold represented by triangulated mesh 
\begin_inset Formula $\Omega$
\end_inset

.
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Formula $E_{D}\left(u\right)=\frac{1}{2}\int_{\Omega}\bigl|\nabla u\bigr|^{2}$
\end_inset


\end_layout

\begin_layout Standard
Taubin 
\begin_inset CommandInset citation
LatexCommand cite
key "Taubin1995"

\end_inset

 was the first to treat the problem of noise reduction in digital polygonal
 meshes from a signal processing point of view.
 He extended Fourier analysis to signals defined on polygonal meshes, and
 observed that Fourier transformation is a decomposition of the signal into
 eigenvectors of the Laplacian operator and reconstructs the signal with
 a linear combination of these eigenvectors.
 Desbrun et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Desbrun1999"

\end_inset

 considered the same approach as Taubin, but they used a curvature normal
 (
\begin_inset Formula $\bar{\kappa}\mathbf{n}$
\end_inset

) based on a cotangent Laplacian operator version for noise reduction over
 a diffusion process.
 This is the most famous and popular Laplace Beltrami operator discretization
 
\begin_inset CommandInset citation
LatexCommand cite
key "Liu2008"

\end_inset

; many works for mesh smoothing and fairing have been developed based on
 this Laplace Beltrami Operator (LBO) discretization 
\begin_inset CommandInset citation
LatexCommand cite
key "Desbrun2000,Meyer2003,Schneider2001,Nealen2006"

\end_inset

:
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Formula $\frac{\partial x_{i}}{\partial t}=-\bar{\kappa_{i}}\mathbf{n_{i}}$
\end_inset


\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Formula $-\bar{\kappa_{i}}\mathbf{n_{i}}=\frac{1}{A}\sum_{j\in N_{1}\left(i\right)}\left(\cot\alpha_{j}+\cot\beta_{j}\right)$
\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $A$
\end_inset

 is the area surrounding vertex 
\begin_inset Formula $i$
\end_inset

.
 This Laplacian operator 
\begin_inset Formula $L$
\end_inset

 was used to reduce the noise in a mesh 
\begin_inset Formula $X$
\end_inset

 over a diffusion process.
\end_layout

\begin_layout Standard
The convergence of the Laplace Beltrami operator has been very important
 in fields such as numerical analysis, given its implications in the simulation
 process and geometric partial differentials equations.
 Xu et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Xu2004"

\end_inset

 established the convergence of several discrete Laplace Beltrami operators
 over triangulated meshes with numerical results that support the theoretical
 analysis.
 Over quadrilateral meshes, Liu et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Liu2008"

\end_inset

 presented a discrete Laplace Beltrami Operator based on a bilinear interpolatio
n and its convergence over meshes composed only by quads.
 
\end_layout

\begin_layout Standard
In the work of Sorkine et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Sorkine2006"

\end_inset

 the Laplacian operator was used to re-pose a mesh while preserving geometry
 details of the surface.
 The details were stored in differential coordinates 
\begin_inset Formula $\delta_{i}$
\end_inset

 for every vertex 
\begin_inset Formula $v_{i}$
\end_inset

.
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Formula $\delta_{i}=\sum_{j\in N_{1}\left(i\right)}\frac{1}{2}\left(\cot\alpha_{j}+\cot\beta_{j}\right)\left(v_{i}-v_{j}\right)$
\end_inset


\end_layout

\begin_layout Standard
The differential coordinates represent the difference between the absolute
 coordinate of 
\begin_inset Formula $v_{i}$
\end_inset

and the center of mass of its immediate neighbors.
\end_layout

\begin_layout Standard
Offset methods for polygon meshing, based on the curvature defined by the
 Laplace Beltrami operator, have been developed.
 These methods adjust the shape offset by a constant distance, with high
 precision.
 Nevertheless, these methods fail to conserve sufficient detail because
 of the smoothing, a crucial issue which depends on the offset size 
\begin_inset CommandInset citation
LatexCommand cite
key "Zhuo2012"

\end_inset

.
 In volumetric approaches, when using point-based representations, the offset
 boundary computation is based on the distance field and therefore when
 calculating such offset, the topology of the model may be different to
 the original 
\begin_inset CommandInset citation
LatexCommand cite
key "Chen2011"

\end_inset

.
\end_layout

\begin_layout Standard
Gal et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Gal2009"

\end_inset

 proposed automatic feature detection and shape edition with feature inter-relat
ionship preservation.
 They defined salient surface features like ridges and valleys, characterized
 by their first and second order curvature derivatives (see 
\begin_inset CommandInset citation
LatexCommand cite
key "Ohtake2004"

\end_inset

) and angle-based thresholds.
 Likewise, curves have also been classified as planar or non-planar, approximate
d by lines, circles, ellipses and other complex shapes.
 In each case, the user defines an initial change over several features
 which is propagated towards other features, based on the classified shapes
 and the inter-relationships between them.
 This method works well with objects that have sharp edges, composed of
 basic geometric shapes such as lines, circles or ellipses.
 However, the method is very limited when models are smooth since it cannot
 find the proper features to edit.
\end_layout

\begin_layout Standard
Traditionally, digital sculpting has been approached under a polygonal represent
ation or a voxel grid-based method.
 Brushes for inflation operations only depend on the vertex normal 
\begin_inset CommandInset citation
LatexCommand cite
key "Stanculescu2011"

\end_inset

.
 In grid-based sculpting, other operations allow the addition or removal
 of voxels, since production of polygonal meshes requires a processing of
 isosurfaces from volume 
\begin_inset CommandInset citation
LatexCommand cite
key "Galyean1991"

\end_inset

.
 The drawback comes from the difficulty of maintaining the surface details
 during larger scale deformations.
\end_layout

\begin_layout Standard
In literature, several studies have described the skeleton extraction systems
 and different metrics that identify appropriate methods given a specific
 application 
\begin_inset CommandInset citation
LatexCommand cite
key "Attali2007"

\end_inset

.
 One of the best methods reported in literature for the extraction of the
 skeleton is the Laplacian smoothing method given its advantages of homotopy
 representation and hierarchical connections between parts.
 The skeleton extraction method permits the simplification of the dimension
 of the object while preserving the topological structure 
\begin_inset CommandInset citation
LatexCommand cite
key "Cornea2007"

\end_inset

.
 Au et.
 al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Au2008"

\end_inset

 present a skeleton extraction method based on iterative smoothing-contraction.
 In this method several constraints are used to guarantee that the process
 converges to a skeleton formed by branches and joints.
 The constraints are based on the Laplacian operator; the low frequencies
 of the mesh are preserved with the use of an attractor to the original
 mesh, while the iterative smoothing process removes high frequencies.
\end_layout

\begin_layout Section
Manifolds
\end_layout

\begin_layout Standard
A manifold is a topological space 
\begin_inset Formula $M$
\end_inset

 with the following properties:
\end_layout

\begin_layout Standard
If 
\begin_inset Formula $x\in M$
\end_inset

, then there is some neighborhood 
\begin_inset Formula $N\left(x\right)$
\end_inset

 and some integer 
\begin_inset Formula $n\geq0$
\end_inset

 such that 
\begin_inset Formula $N(x)$
\end_inset

 is homeomorphic to 
\begin_inset Formula $\mathbb{R}^{n}$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand cite
key "Spivak1-1999"

\end_inset

.
 
\end_layout

\begin_layout Standard
Our work is related to manifolds that represent a surface in an three-dimensiona
l Euclidean Space.
 These manifolds are homeomorphic to 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $\mathbb{R}^{2}$
\end_inset

.
\end_layout

\begin_layout Standard
The manifolds are represented by polygonal meshes with points connected
 by triangles and quads.
\end_layout

\begin_layout Section
Laplace Operator
\end_layout

\begin_layout Standard
In computer graphics a manifold is often approximated by a discrete mesh
 
\begin_inset CommandInset citation
LatexCommand cite
key "Ranjan2012"

\end_inset

, it is therefore necessary to define a discrete Laplacian operator that
 acts on functions defined by such meshes.
\end_layout

\begin_layout Standard
Consider a smooth compact manifold 
\begin_inset Formula $M$
\end_inset

 of dimension 
\begin_inset Formula $m$
\end_inset

 isometrically embedded in a Euclidean space 
\begin_inset Formula $\mathbb{R}^{d}$
\end_inset

.
 
\end_layout

\begin_layout Standard
Given a twice continuously differentiable function 
\begin_inset Formula $f\in C^{2}\left(M\right)$
\end_inset

, let 
\begin_inset Formula $\nabla_{\mbox{M}}f$
\end_inset

 denote the gradient vector field of 
\begin_inset Formula $f$
\end_inset

 on 
\begin_inset Formula $M$
\end_inset

.
 
\end_layout

\begin_layout Standard
The Laplace-Beltrami operator 
\begin_inset Formula $\Delta_{\mbox{M}}$
\end_inset

 of 
\begin_inset Formula $f$
\end_inset

 is defined as the divergence of the gradient; that is 
\begin_inset CommandInset citation
LatexCommand cite
key "Spivak1-1999"

\end_inset

,
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Formula $\frac{\partial^{2}f}{\partial x^{2}}+\frac{\partial^{2}f}{\partial y^{2}}+\frac{\partial^{2}f}{\partial z^{2}}=0$
\end_inset


\end_layout

\begin_layout Standard
\noindent
\align center

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\nabla_{\mbox{M}}^{2}f=\Delta_{\mbox{M}}f=0$
\end_inset


\end_layout

\begin_layout Standard
\noindent
\begin_inset Formula 
\begin{equation}
\Delta_{\mbox{M}}f=div\left(\nabla_{\mbox{M}}f\right)
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Discrete Laplace Operator Setting
\end_layout

\begin_layout Standard
Discrete Laplacian operators are linear operators that act on functions
 defined by meshes.
 These functions are defined by their values at the vertices.
 
\end_layout

\begin_layout Standard
Thus, if a mesh 
\begin_inset Formula $M$
\end_inset

 has 
\begin_inset Formula $n$
\end_inset

 vertices, then functions on 
\begin_inset Formula $M$
\end_inset

 will be represented by vectors with 
\begin_inset Formula $n$
\end_inset

 components and a mesh Laplacian will be described by an 
\begin_inset Formula $n\times n$
\end_inset

 matrix 
\begin_inset CommandInset citation
LatexCommand cite
key "Ranjan2012"

\end_inset

.
\end_layout

\begin_layout Standard
Locally, the Laplacian operator takes the difference between the value of
 a function at a vertex and a weighted average of its values at the first-order
 or one-ring neighbor vertices, therefore a Laplacian matrix 
\begin_inset Formula $L$
\end_inset

 has a local form that is given by
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Formula $L\left(f\right)_{i}=b_{i}^{-1}\underset{j\in N\left(i\right)}{\sum}w_{ij}\left(f_{i}-f_{j}\right)$
\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $w_{ij}$
\end_inset

are the weights between the vertex 
\begin_inset Formula $i$
\end_inset

 and the vertex 
\begin_inset Formula $j$
\end_inset

.
 
\begin_inset Formula $b_{i}^{-1}$
\end_inset

 are the factors depending on the boundary region over vertex 
\begin_inset Formula $i$
\end_inset

.
 
\begin_inset Formula $N\left(i\right)$
\end_inset

 denotes the neighbors that share an edge with vertex 
\begin_inset Formula $i$
\end_inset

.
\end_layout

\begin_layout Chapter
Shape Inflation With an Adapted Laplacian Operator For Hybrid Quad/Triangle
 Meshes
\begin_inset CommandInset label
LatexCommand label
name "chap:SibgrapiPaper"

\end_inset


\end_layout

\begin_layout Standard
\noindent
\align center
Alexander Pinzón, Eduardo Romero
\begin_inset Newline newline
\end_inset

Cimalab Research Group
\begin_inset Newline newline
\end_inset

Universidad Nacional de Colombia
\begin_inset Newline newline
\end_inset

Bogota-Colombia
\begin_inset Newline newline
\end_inset

Email: apinzonf@unal.edu.co, edromero@unal.edu.co
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename resources/figs/spectrum.pdf
	lyxscale 30
	width 100text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "PAPER:fig:Spectrum"

\end_inset

A set of 48 successive shapes enhanced, from 
\begin_inset Formula $\lambda=0.0$
\end_inset

 in blue to 
\begin_inset Formula $\lambda=-240.0$
\end_inset

 in red, with steps of 
\begin_inset Formula $-5.0$
\end_inset

.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
This paper was accepted and presented in the Brazilian Symposium on Computer
 Graphics and Image Processing SIBGRAPI 2013.
 The conference was held on August 5-8 of 2013, in the city of Arequipa,
 Perú 
\begin_inset CommandInset citation
LatexCommand cite
key "Pinzon2013"

\end_inset

.
\end_layout

\begin_layout Section*
Abstract
\end_layout

\begin_layout Standard
This paper proposes a novel modeling method for a hybrid quad/triangle mesh
 that allows to set a family of possible shapes by controlling a single
 parameter, the global curvature.
 The method uses an original extension of the Laplace Beltrami operator
 that efficiently estimates a curvature parameter, which is used to define
 an inflated shape after a particular operation performed in certain mesh
 points.
 Along with the method, this work presents new applications in sculpting
 and modeling, with the subdivision of surfaces and weight vertex groups.
 A series of graphics demonstrates the quality, predictability and flexibility
 of the method in a real production environment with software Blender.
\end_layout

\begin_layout Description
keywords- laplacian smooth; curvature; sculpting; subdivision surface
\end_layout

\begin_layout Section
Introduction
\end_layout

\begin_layout Standard
Over the last several years, modeling techniques that are able to generate
 a variety of realistic shapes, have been developed 
\begin_inset CommandInset citation
LatexCommand cite
key "Botsch2006"

\end_inset

.
 Editing techniques have evolved from affine transformations to advanced
 tools like sculpting 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cite{Coquillart1990,Galyean1991,Stanculescu2011}
\end_layout

\end_inset

, editing, creation from sketches 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cite{Igarashi1999,Gonen2012}
\end_layout

\end_inset

, and complex interpolation techniques 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cite{Sorkine2004,Zhou2005}
\end_layout

\end_inset

.
 Catmull-Clark based methods however require interaction with a small number
 of control points for any operation to be efficient, or in other words,
 a unity  condition is introduced by demanding a smooth surface after any
 of these shape operations.
 Hence, traditional modeling methods for subdividing surfaces from coarse
 geometry have become widely popular 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cite{Catmull1978,Stam1998}
\end_layout

\end_inset

.
 These works have generalized a uniform B-cubic spline knot insertion to
 meshes, some of them adding some type of control, for instance with the
 use of creases to produce sharp edges 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cite{DeRose1998}
\end_layout

\end_inset

, or the modification of some vertex weights to locally control the zone
 of influence 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cite{Biermann2000}
\end_layout

\end_inset

.
 Nevertheless, these methods are difficult to deal with since they require
 a large number of parameters and a very tedious customization.
 Instead, the presented method requires a single parameter that controls
 the global curvature, which is used to maintain realistic shapes, creating
 a family of different versions of the same object and therefore preserving
 the detail of the original model and a realistic appearance.
 
\end_layout

\begin_layout Standard
Interest in meshes composed of triangles and quads has lately increased
 because of the flexibility of modeling tools such as Blender 3D 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cite{blender}
\end_layout

\end_inset

.
 Nowadays, many artists use a manual connection of a couple of vertices
 to perform animation processes and interpolation 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cite{Mullen2007}
\end_layout

\end_inset

.
 It is then of paramount importance to develop operators that easily interact
 with such meshes, eliminating the need of preprocessing the mesh to convert
 it to triangles.
 The shape inflation and shape exaggeration can thus be used as a brush
 in the sculpting process, when inflating a shape, since current brushes
 end up losing detail when moving vertices 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cite{Stanculescu2011}
\end_layout

\end_inset

.
 In contrast, the presented method inflates a mesh by moving the vertices
 towards the reverse curvature direction, conserving the shape and sharp
 features of the model.
\end_layout

\begin_layout Subsection*
Contributions 
\end_layout

\begin_layout Standard
This work presents an extension of the Laplace Beltrami operator for hybrid
 quad/triangle meshes, representing a larger mesh spectrum from what has
 been presented so far.
 The method eliminates the need of preprocessing and allows preservation
 of the original topology.
 Likewise, along with this operator, a method has been proposed to generate
 a family of parametrized shapes, in a robust and predictable way.
 This method enables customization of the smoothness and curvature obtained
 during the subdivision surfaces process.
 Finally, a new brush has been proposed for inflating the silhouette mesh
 features in modeling and sculpting.
\end_layout

\begin_layout Standard
This work is organized as follows: Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Related-work"

\end_inset

 presents works related to the Laplacian mesh processing, digital sculpting,
 and offsetting methods for polygonal meshes; in section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Laplacian-Smooth"

\end_inset

, the theoretical framework of the Laplacian operator for polygon meshes
 is described; in section 
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:sec:Proposed-Method"

\end_inset

, the method for shape inflation and applications of subdivision of surfaces
 and sculpting is presented; finally some Laplacian operator results using
 hybrid quad/triangle meshes are shown graphically, as well as results of
 the shape inflation applications in sculpting, subdivision and modeling.
\end_layout

\begin_layout Section
Related work
\begin_inset CommandInset label
LatexCommand label
name "sec:Related-work"

\end_inset


\end_layout

\begin_layout Standard
Many tools have been developed for modeling, based on the Laplacian mesh
 processing.
 Thanks to the advantages of the Laplacian operator, these different tools
 preserve the surface geometric details when being used for different processes
 such as free-form deformation, fusion, morphing and other applications
 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cite{Sorkine2004}
\end_layout

\end_inset

.
 
\end_layout

\begin_layout Standard
Offset methods for polygon meshing, based on the curvature defined by the
 Laplace Beltrami operator, have been developed.
 With enough precision, these methods adjust the shape offset by a constant
 distance.
 Nevertheless, these methods fail to conserve sufficient detail because
 of the smoothing, a crucial issue which depends on the offset size 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cite{Zhuo2012}
\end_layout

\end_inset

.
 In volumetric approaches, in the case of point-based representations, the
 offset boundary computation is based on the distance field, and therefore
 when calculating such offset the topology of the model may be different
 to the original 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cite{Chen2011}
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cite{Gal2009}
\end_layout

\end_inset

 proposes automatic feature detection and shape edition with feature inter-relat
ionship preservation.
 They define salient surface features like ridges and valleys, characterized
 by their first and second order curvature derivatives, see 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cite{Ohtake2004}
\end_layout

\end_inset

, and angle-based threshold.
 Likewise, curves have been also classified as planar or non-planar, approximate
d by lines, circles, ellipses and other complex shapes.
 In such cases, the user defines an initial change over several features
 which are propagated towards other features, based on the classified shapes
 and the inter-relationships between them.
 This method works well with objects that have sharp edges, composed of
 basic geometric shapes such as lines, circles or ellipses.
 However, the method is very limited when models are smooth since it cannot
 find the proper features to edit.
\end_layout

\begin_layout Standard
Traditionally, digital sculpting has been approached under a polygonal represent
ation or a voxel grid-based method.
 Brushes for inflation operations only depend on the vertex normal 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cite{Stanculescu2011}
\end_layout

\end_inset

.
 In grid-based sculpting, some other operations have allowed the addition
 or removal of voxels since production of polygonal meshes requires a processing
 of isosurfaces from volume 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cite{Galyean1991}
\end_layout

\end_inset

.
 The drawback comes from the difficulty of maintaining the surface details
 during larger scale deformations.
 
\end_layout

\begin_layout Section
Laplacian Smooth
\begin_inset CommandInset label
LatexCommand label
name "sec:Laplacian-Smooth"

\end_inset


\end_layout

\begin_layout Standard
Computer objects, reconstructed from the real world, are usually noisy.
 Laplacian Smooth techniques allow a proper noise reduction on the mesh
 surface with minimal shape changes, while still preserving a desirable
 geometry as well as the original shape.
 
\end_layout

\begin_layout Standard
Many smoothing Laplacian functionals regularize the surface energy by controllin
g the total surface curvature 
\begin_inset Formula $S$
\end_inset

.
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Formula $E\left(S\right)=\int_{S}\kappa_{1}^{2}+\kappa_{2}^{2}dS$
\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $\kappa_{1}$
\end_inset

 and 
\begin_inset Formula $\kappa_{2}$
\end_inset

 are the two principal curvatures of the surface 
\begin_inset Formula $S$
\end_inset

.
\end_layout

\begin_layout Subsection
Gradient of Voronoi Area
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename resources/figs/voronoi_region.pdf
	width 100text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:voronoi_region-1"

\end_inset

Area of the Voronoi region around 
\begin_inset Formula $v_{i}$
\end_inset

 in dark blue.
\begin_inset Formula $v_{j}$
\end_inset

 belong to the first neighborhood around 
\begin_inset Formula $v_{i}$
\end_inset

.
 
\begin_inset Formula $\alpha_{j}$
\end_inset

 and 
\begin_inset Formula $\beta_{j}$
\end_inset

 are opposite angles to edge 
\begin_inset Formula $\overrightarrow{v_{j}-v_{i}}$
\end_inset

.
 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Consider a surface 
\begin_inset Formula $S$
\end_inset

 composed of a set of triangles around vertex 
\begin_inset Formula $v_{i}$
\end_inset

.
 Let us define the 
\shape slanted
Voronoi region
\shape default
 of 
\begin_inset Formula $v_{i}$
\end_inset

 as shown in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:voronoi_region-1"

\end_inset

.
 The area change produced by the movement of 
\begin_inset Formula $v_{i}$
\end_inset

 is called the gradient of 
\shape slanted
Voronoi region
\shape default
 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cite{Pinkall1993,Desbrun1999,Meyer2003}
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\nabla A=\frac{1}{2}\underset{j}{\sum}\left(\cot\alpha_{j}+\cot\beta_{j}\right)\label{PAPER:eq:eq_gradient_voronoi_area}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
If the gradient in equation (
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:eq:eq_gradient_voronoi_area"

\end_inset

) is normalized by the total area of the 
\begin_inset Formula $1$
\end_inset

-ring neighborhood around 
\begin_inset Formula $v_{i}$
\end_inset

, the 
\shape slanted
discrete mean curvature normal
\shape default
 of a surface 
\begin_inset Formula $S$
\end_inset

 is obtained, as shown in equation (
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:eq:discrete_mean_curvature_normal"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
2\kappa\mathbf{n}=\frac{\nabla A}{A}\label{PAPER:eq:discrete_mean_curvature_normal}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Laplace Beltrami Operator
\end_layout

\begin_layout Standard
The 
\shape slanted
Laplace Beltrami operator
\shape default
 LBO noted as 
\begin_inset Formula $\triangle$
\end_inset

 is used for measuring the mean curvature normal to the Surface 
\begin_inset Formula $S$
\end_inset

 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cite{Pinkall1993}
\end_layout

\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\triangle S=2\kappa\mathbf{n}\label{PAPER:eq:def_LBO}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The LBO has desirable properties: the LBO points to the reverse direction
 of the minimal surface area.
\end_layout

\begin_layout Section
Proposed Method
\begin_inset CommandInset label
LatexCommand label
name "PAPER:sec:Proposed-Method"

\end_inset


\end_layout

\begin_layout Standard
This method exaggerates a shape using a Laplacian smoothing operator in
 the reverse direction, i.e., the new shape is a modified version in which
 those areas with larger curvature are magnified.
 The operator amounts to a generator of a set of models, which conserves
 the basic silhouette of the original shape.
 In addition, the presented approach can be easily mixed with traditional
 or uniform subdivision of surfaces.
 This method is based on an original extension of the Laplace Beltrami operator
 for hybrid quad/triangle meshes, mixing arbitrary types of meshes, exploiting
 the basic geometrical relationships and ensuring good results with few
 algorithm iterations.
 
\end_layout

\begin_layout Subsection
Laplace Beltrami Operator for Hybrid Quad/Triangle Meshes TQLBO
\begin_inset CommandInset label
LatexCommand label
name "PAPER:sub:Laplace-Beltrami-Operator"

\end_inset


\end_layout

\begin_layout Standard
Given a mesh 
\begin_inset Formula $M=\left(V,Q,T\right)$
\end_inset

, with vertices 
\begin_inset Formula $V$
\end_inset

, quads 
\begin_inset Formula $Q$
\end_inset

, triangles 
\begin_inset Formula $T$
\end_inset

.
 The area of 
\begin_inset Formula $1$
\end_inset

-ring neighborhood 
\begin_inset Formula $A\left(v_{i}\right)$
\end_inset

 corresponds to a sum of the quad faces 
\begin_inset Formula $A\left(Q_{v_{i}}\right)$
\end_inset

 and the areas of the triangular faces 
\begin_inset Formula $\ensuremath{A\left(T_{v_{i}}\right)}$
\end_inset

 adjacent to vertex 
\begin_inset Formula $\ensuremath{v_{i}}$
\end_inset

.
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Formula $\ensuremath{A\left(v_{i}\right)=A\left(Q_{v_{i}}\right)+A\left(T_{v_{i}}\right)}$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename resources/figs/quad_xiong.pdf
	lyxscale 30
	width 100col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "PAPER:fig:quad_xiong"

\end_inset


\begin_inset Formula $t_{j1}^{*}\equiv\vartriangle v_{i}v_{j}v_{j}^{\prime},\,t_{j2}^{*}\equiv\vartriangle v_{i}v_{j}^{\prime}v_{j+1},\,t_{j3}^{*}\equiv\vartriangle v_{i}v_{j}v_{j+1}$
\end_inset

 Triangulations of the quad with common vertex 
\begin_inset Formula $v_{i}$
\end_inset

 proposed by [Xiong 2011] to define Mean LBO.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Applying the mean average area, according to 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cite{Xiong2011}
\end_layout

\end_inset

, from all possible triangulations, as show in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:fig:quad_xiong"

\end_inset

, the area for quads 
\begin_inset Formula $\ensuremath{A\left(Q_{v_{i}}\right)}$
\end_inset

 and triangles 
\begin_inset Formula $A\left(T_{v_{i}}\right)$
\end_inset

 is
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Formula $A\left(v_{i}\right)=\frac{1}{2^{m}}\overset{m}{\underset{j=1}{\sum}}2^{m-1}A\left(q_{j}\right)+\overset{r}{\underset{k=1}{\sum}}A\left(t_{k}\right)$
\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $q_{1},q_{2},...,q_{j},...,q_{m}\in Q_{v_{i}}$
\end_inset

 and 
\begin_inset Formula $t_{1},t_{2},...,t_{k},...,t_{r}\in T_{v_{i}}$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
A\left(v_{i}\right)=\frac{1}{2}\overset{m}{\underset{j=1}{\sum}}\left[A\left(t_{j1}^{*}\right)+A\left(t_{j2}^{*}\right)+A\left(t_{j3}^{*}\right)\right]+\overset{r}{\underset{k=1}{\sum}}A\left(t_{k}\right)\label{PAPER:eq:area_1_ring_triangles_quads}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Applying the gradient operator to (
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:eq:area_1_ring_triangles_quads"

\end_inset

)
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Formula $\nabla A\left(v_{i}\right)=\frac{1}{2}\overset{m}{\underset{j=1}{\sum}}\left[\nabla A\left(t_{j1}^{*}\right)+\nabla A\left(t_{j2}^{*}\right)+\nabla A\left(t_{j3}^{*}\right)\right]+\overset{r}{\underset{k=1}{\sum}}\nabla A\left(t_{k}\right)$
\end_inset


\end_layout

\begin_layout Standard
According to (
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:eq:eq_gradient_voronoi_area"

\end_inset

), we have
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Formula $\nabla A\left(t_{j1}^{*}\right)=\frac{\cot\theta_{j3}\left(v_{j}-v_{i}\right)+\cot\theta_{j2}\left(v_{j}^{\prime}-v_{i}\right)}{2}$
\end_inset


\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Formula $\nabla A\left(t_{j2}^{*}\right)=\frac{\cot\theta_{j5}\left(v_{j}^{\prime}-v_{i}\right)+\cot\theta_{j4}\left(v_{j+1}-v_{i}\right)}{2}$
\end_inset


\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Formula $\nabla A\left(t_{j3}^{*}\right)=\frac{\cot\theta_{j6}\left(v_{j}-v_{i}\right)+\cot\theta_{j1}\left(v_{j+1}-v_{i}\right)}{2}$
\end_inset


\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Formula $\nabla A\left(t_{k}\right)=\frac{\cot\alpha_{k}\left(v_{k}-v_{i}\right)+\cot\beta_{k+1}\left(v_{k+1}-v_{i}\right)}{2}$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename resources/figs/beltrami.pdf
	lyxscale 50
	width 100text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "PAPER:fig:LBO-basic-5-TQ-1"

\end_inset

The 5 basic triangle-quad cases with common vertex 
\begin_inset Formula $V_{i}$
\end_inset

 and the relationship with 
\begin_inset Formula $V_{j}$
\end_inset

 and 
\begin_inset Formula $V_{j}^{\prime}$
\end_inset

.
 (a) Two triangles [Desbrun 1999].
 (b) (c) Two quads and one quad [Xiong 2011].
 (d) (e) Triangles and quads (TQLBO) our contribution.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Triangle and quad configurations of the 1-ring neighborhood faces, adjacent
 to 
\begin_inset Formula $v_{i}$
\end_inset

, can be simplified to five cases, as shown in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:fig:LBO-basic-5-TQ-1"

\end_inset

.
\end_layout

\begin_layout Standard
According to equation (
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:eq:discrete_mean_curvature_normal"

\end_inset

), (
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:eq:def_LBO"

\end_inset

), and five simple cases defined in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:fig:LBO-basic-5-TQ-1"

\end_inset

 the TQLBO (Triangle-Quad LBO) of 
\begin_inset Formula $v_{i}$
\end_inset

 is
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Formula $\triangle_{S}\left(v_{i}\right)=2\kappa\mathbf{n}=\frac{\nabla A}{A}=\underset{v_{j}\in N_{1}\left(v_{i}\right)}{\frac{1}{2A}\sum}w_{ij}\left(v_{j}-v_{i}\right)$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
w_{ij}=\begin{cases}
\left(\cot\alpha_{j}+\cot\beta_{j}\right) & \mbox{case }\mathit{a.}\\
\frac{1}{2}\left(\cot\theta_{\left(j-1\right)1}+\cot\theta_{\left(j-1\right)4}+\cot\theta_{j3}+\cot\theta_{j6}\right) & \mbox{case \ensuremath{\mathit{b}}.}\\
\left(\cot\theta_{j2}+\cot\theta_{j5}\right) & \mbox{case \ensuremath{\mathit{c}}.}\\
\frac{1}{2}\left(\cot\theta_{j3}+\cot\theta_{j6}\right)+\cot\beta_{j} & \mbox{case \ensuremath{\mathit{d}}.}\\
\frac{1}{2}\left(\cot\theta_{\left(j-1\right)1}+\cot\theta_{\left(j-1\right)4}\right)+\cot\alpha_{j} & \mbox{case \ensuremath{\mathit{e}}.}
\end{cases}\label{PAPER:eq:TQLBO_wij}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
We define a TQLBO as a matrix equation
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
L\left(i,j\right)=\begin{cases}
-\frac{1}{2A_{i}}w_{ij} & \mbox{if }j\in N\left(v_{i}\right)\\
\frac{1}{2A_{i}}\underset{j\in N\left(v_{i}\right)}{\sum}w_{ij} & \mbox{if }i=j\\
0 & \mbox{otherwise}
\end{cases}\label{PAPER:eq:TQLBO_Simple_Matrix}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $L$
\end_inset

 is a 
\begin_inset Formula $n\times n$
\end_inset

 matrix, 
\begin_inset Formula $n$
\end_inset

 is the number of vertices of a given mesh 
\begin_inset Formula $M$
\end_inset

, 
\begin_inset Formula $w_{ij}$
\end_inset

 is the TQLBO defined in equation (
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:eq:TQLBO_wij"

\end_inset

), 
\begin_inset Formula $N\left(v_{i}\right)$
\end_inset

 is the 1-ring neighborhood with a shared face to 
\begin_inset Formula $v_{i}$
\end_inset

 and 
\begin_inset Formula $A_{i}$
\end_inset

 is the ring area around 
\begin_inset Formula $v_{i}$
\end_inset

.
\end_layout

\begin_layout Standard
Normalized equation of the TQLBO
\end_layout

\begin_layout Standard
\noindent
\begin_inset Formula 
\begin{equation}
L\left(i,j\right)=\begin{cases}
-\frac{w_{ij}}{\underset{j\in N\left(v_{i}\right)}{\sum}w_{ij}} & \mbox{if }j\in N\left(v_{i}\right)\\
\delta_{ij} & \mbox{otherwise}
\end{cases}\label{PAPER:eq:TQLBO-Normalized_Matrix}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $\delta_{ij}$
\end_inset

 is the Kronecker delta function.
\end_layout

\begin_layout Subsection
The Shape Inflation
\begin_inset CommandInset label
LatexCommand label
name "PAPER:sub:Curvature-Enhancing"

\end_inset


\end_layout

\begin_layout Standard
The shape is inflated using the reverse direction of the curvature flow,
 moving the vertices towards those mesh portions with larger curvature.
 A standard diffusion process is applied:
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Formula $\frac{\partial V}{\partial t}=\lambda L\left(V\right)$
\end_inset

 
\end_layout

\begin_layout Standard
To solve this equation, implicit integration is used as well as a normalized
 version of TQLBO matrix
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\left(I-\left|\lambda dt\right|W_{p}L\right)V^{\prime}=V^{t}\label{PAPER:eq:Lineal_System_with_wp}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Formula $V^{t+1}=V^{t}+\mbox{sign}\left(\lambda\right)\left(V^{\prime}-V^{t}\right)$
\end_inset

 
\end_layout

\begin_layout Standard
The vertices 
\begin_inset Formula $V^{t+1}$
\end_inset

 are inflated, along their reverse curvature direction, by solving the linear
 system: 
\begin_inset Formula $Ax=b$
\end_inset

, where 
\begin_inset Formula $A=I-\left|\lambda dt\right|W_{p}L$
\end_inset

, 
\begin_inset Formula $L$
\end_inset

 is the Normalized TQLBO defined in the equation (
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:eq:TQLBO-Normalized_Matrix"

\end_inset

), 
\begin_inset Formula $x=V^{\prime}$
\end_inset

 are the smoothing vertices, 
\begin_inset Formula $b=V^{t}$
\end_inset

 are the actual vertices positions, 
\begin_inset Formula $W_{p}$
\end_inset

 is a diagonal matrix with vertex weights, and 
\begin_inset Formula $\lambda dt$
\end_inset

 is the inflate factor that supports negative and positive values: negative
 for inflation and positive for smoothing.
 
\end_layout

\begin_layout Standard
The method was devised to use with weighted vertex groups, which specify
 the final shape inflation of the solution, meaning 
\begin_inset Formula $0$
\end_inset

 for no changes and 1 when a maximal change is applied.
 The weights modify the influence zones, where the Laplacian is applied,
 as shown in equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:eq:Lineal_System_with_wp"

\end_inset

 .
 Interestingly, the generated family of shapes may change substantially
 with the weights of specific control points.
\end_layout

\begin_layout Standard
The curvature cannot be calculated at the boundary of the meshes that are
 not closed, for that reason we use the scale-dependent operator proposed
 by Desbrun et al.
 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cite{Desbrun1999}
\end_layout

\end_inset

, the inflation factor for boundary is represented by 
\begin_inset Formula $\lambda_{e}$
\end_inset

.
\end_layout

\begin_layout Standard
The model volume increases proportionally as the lambda becomes larger and
 negative, this can be counteracted with a simple volume preservation.
 However, the mesh may suffer large displacements when 
\begin_inset Formula $\lambda<-1.0$
\end_inset

 or after multiple iterations.
 A simple volume conservation algorithm is: if 
\begin_inset Formula $v_{i}^{t+1}$
\end_inset

 is a mesh vertex of 
\begin_inset Formula $V^{t+1}$
\end_inset

 in the 
\begin_inset Formula $t+1$
\end_inset

 iteration, we define 
\begin_inset Formula $\overline{v}$
\end_inset

 as:
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Formula $\overline{v}=\frac{1}{n}\underset{v_{i}\in V}{\sum}v_{i}$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $\overline{v}$
\end_inset

is the mesh center, 
\begin_inset Formula $vol_{ini}$
\end_inset

 is an initial volume, and 
\begin_inset Formula $vol_{t+1}$
\end_inset

 is the volume at the iteration 
\begin_inset Formula $t+1$
\end_inset

, 
\begin_inset Formula $n$
\end_inset

 is the number of vertices, then the scale factor
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Formula $\beta=\left(\frac{vol_{ini}}{vol_{t+1}}\right)^{\frac{1}{3}}$
\end_inset

 
\end_layout

\begin_layout Standard
allows to scale the vertices to:
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Formula $v_{i\,new}^{t+1}=\beta\left(v_{i}^{t+1}-\overline{v}\right)+\overline{v}$
\end_inset

 
\end_layout

\begin_layout Standard
The shape inflation uses a negative curvature flow that is an unstable process
 when performing many iterations, however, our method uses less than 3 iteration
s to get good results, and with 3 iterations or less the method behaves
 in a stable way.
\end_layout

\begin_layout Section
Sculpting
\begin_inset CommandInset label
LatexCommand label
name "PAPER:sec:Sculpting"

\end_inset


\end_layout

\begin_layout Standard
A new sculpting brush is herein proposed and aims to inflate the shape,
 magnifying the shape curvatures of a polygon mesh in real time.
 This brush works best with the stroke method 
\shape slanted
Drag Dot
\shape default
, allowing the user to pre-visualize the model changes before the mouse
 is released.
 Also, it allows movement of the mouse along the model to match the shape
 zone which is supposed to be inflated.
\end_layout

\begin_layout Standard
Brushes that perform a similar inflation can introduce mesh distortions
 or produce mesh self-intersections, provided that these brushes only move
 the vertices along the normal without any global information.
 In contrast, the present method searches for an improved inflation while
 preserving the global curvature, retaining the original shape and main
 model features.
 In addition, this method simplifies the work required for the inflation
 since it does not need different brushes for inflating, softening or styling.
 The inflated brush can do all these operations in a single step.
 Real-time brushes require the Laplacian matrix to be constructed with the
 vertices that are within the sphere radius defined by the user, reducing
 the matrix to be processed.
 The center of this sphere depends on the place where the user clicks on
 the canvas and also where the click is projected on the three-dimensional
 mesh.
 Special handling is required for the boundary vertices with neighbors that
 are not within the brush radius: these vertices mark the boundary though
 the curvature is not calculated there, but they must be included in the
 matrix so that every vertex has their corresponding neighbors within the
 selection.
 The sculpting Laplacian matrix reads as.
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Formula $\ensuremath{L\left(i,j\right)=\begin{cases}
-\frac{w_{ij}}{\underset{j\in N\left(v_{i}\right)}{\sum}w_{ij}} & \mbox{if }\left\Vert v_{i}-u\right\Vert <r\wedge\left\Vert v_{j}-u\right\Vert <r\\
0 & \mbox{if }\left\Vert v_{i}-u\right\Vert <r\wedge\left\Vert v_{j}-u\right\Vert \geq r\\
\delta_{ij} & \mbox{otherwise}
\end{cases}}$
\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $v_{j}\in N\left(v_{i}\right)$
\end_inset

, 
\begin_inset Formula $u$
\end_inset

 is the sphere center of radius 
\begin_inset Formula $r$
\end_inset

.
 The matrices should remove rows and columns of vertices that are not within
 the radius.
\end_layout

\begin_layout Section
Subdivision surfaces
\begin_inset CommandInset label
LatexCommand label
name "PAPER:sec:Subdivision-surfaces"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename resources/figs/teaser_cup.pdf
	lyxscale 10
	width 100text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "PAPER:fig:Subdivision-Cups"

\end_inset

 Family of cups generated with our method, from a coarse model (a), (c):
 the shape, obtained from the Catmull-Clark Subdivision (b), (d), is inflated.
 Soft constraints, over the coarse model, is drawn in red and blue (c).
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The Catmull-Clark subdivision transformation is used to smoothen a surface,
 as the limit of a sequence of subdivision steps 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cite{Stam1998}
\end_layout

\end_inset

.
 This process is governed by a B-spline curve 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cite{Loop1987}
\end_layout

\end_inset

, performing a recursive subdivision transformation that refines the model
 into a linear interpolation that approximates a smooth surface.
 The model smoothness is automatically guaranteed 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cite{DeRose1998}
\end_layout

\end_inset

.
 
\end_layout

\begin_layout Standard
Catmull-Clark subdivision surface methods generate smooth and continuous
 models from a coarse model and produce quick results because of the simplicity
 of implementation.
 Nevertheless, changes to the global curvature are hardly implantable.
 The Catmull-Clark Subdivision Surfaces, together with shape inflation,
 can easily generate families of shapes by changing a single parameter,
 allowing a model with very few vertices to be handled.
 In practice, this would allow an artist to choose a model from a similar
 set of options that would meet their needs without having to change each
 of the control vertices.
 Likewise, the presented method allows the use of vertex weight paint over
 the control points.
 The weights can be applied to a coarse model, followed by a Catmull-Clark
 subdivision where weights are interpolated, producing weights with smooth
 changes in the influence zones, as shown in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:fig:Subdivision-Cups"

\end_inset

.c.
\end_layout

\begin_layout Standard
In equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:eq:Lineal_System_with_wp"

\end_inset

, 
\begin_inset Formula $W_{p}$
\end_inset

 is a diagonal matrix with weights corresponding to each vertex.
 Weights at each vertex produce a different solution so that the matrix
 must be placed in the diffusion equation, since families that are generated
 may change substantially with the weight of specific control points.
\end_layout

\begin_layout Section
Results
\begin_inset CommandInset label
LatexCommand label
name "PAPER:sec:Results"

\end_inset


\end_layout

\begin_layout Standard
The results of the shape inflation method with the extension of the Laplace
 Beltrami operator for hybrid quad/triangle meshes with several example
 models shown in figures: 
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:fig:Spectrum"

\end_inset

, 
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:fig:Subdivision-Cups"

\end_inset

, 
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:fig:Catmull_Clark"

\end_inset

, 
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:fig:TQLBO_test"

\end_inset

, 
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:fig:camello_enhanced"

\end_inset

, 
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:fig:Sculpt_Brush"

\end_inset

, 
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:fig:Performance-sculpt"

\end_inset

, 
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:fig:(a)Monkey"

\end_inset

, 
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:fig:Animated_Camell"

\end_inset

.
 The shape inflation was assessed with TQLBO method on a PC with AMD Quad-Core
 Processor @ 2.40 GHz and 8 GB RAM.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename resources/figs/cruz_lambda4.pdf
	lyxscale 10
	width 100text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "PAPER:fig:Catmull_Clark"

\end_inset

(a) Original Model, (b) Model with Catmull-Clark Subdivision.
 Models with Laplacian smoothing: (c) and (d).
 Models with a first Laplacian filtering 
\begin_inset Formula $\lambda=60.0$
\end_inset

, 
\begin_inset Formula $\lambda_{e}=12.0$
\end_inset

 and before applying shape inflation: (e) and (f).
 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:fig:TQLBO_test"

\end_inset

 shows the results when applying the Laplace Beltrami Operator TQLBO of
 equation (
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:eq:TQLBO_Simple_Matrix"

\end_inset

) in a model with a simple subdivision.
 In column (c) the Laplacian smoothing was applied to a model consisting
 of only quads.
 In column (d) the model was converted to triangles and then the Laplacian
 smoothing was applied.
 In column (e) the model was randomly converted from some quads into triangles
 and then the Laplacian smoothing was applied, showing similar results to
 those meshes composed only of triangles or quads.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename resources/figs/test_triangles_quads.pdf
	lyxscale 60
	height 50theight%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "PAPER:fig:TQLBO_test"

\end_inset

(a) Original Model.
 (b) Simple subdivision.
 (c), (d) (e) Laplacian smoothing with 
\begin_inset Formula $\lambda=7$
\end_inset

 and 2 iterations: (c) for triangles, (d) for quads, (e) for triangles and
 quads chosen randomly.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Methods using the Catmull-Clark Subdivision Surface and inflation allow
 the modification of the curvature, as shown in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:fig:Subdivision-Cups"

\end_inset

.
 This test used a coarse cup model, in which the subdivision was performed,
 followed by Laplacian smoothing and inflation.
 Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:fig:Subdivision-Cups"

\end_inset

.c, 
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:fig:Subdivision-Cups"

\end_inset

.d also shows the use of weight vertex groups over coarse models, with subdivisio
n surfaces that generate weights for the new interpolated vertices.
 These new weights were used for the inflation obtained on the 6 cups that
 are at the right of the figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:fig:Subdivision-Cups"

\end_inset

.d.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename resources/figs/camello_enhanced2.pdf
	lyxscale 80
	height 50theight%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "PAPER:fig:camello_enhanced"

\end_inset

Top row: Original camel model in left.
 Shape inflation with 
\begin_inset Formula $\lambda=-30.0$
\end_inset

, 
\begin_inset Formula $\lambda=-100.0$
\end_inset

, 
\begin_inset Formula $\lambda=-400.0$
\end_inset

.
 Bottom row: Shape inflation with weight vertex group, 
\begin_inset Formula $\lambda=-50.0$
\end_inset

 and 2 iterations for the legs, 
\begin_inset Formula $\lambda=-200.0$
\end_inset

 and 1 iteration for the head and neck.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Laplacian smoothing applied with simple subdivision (see figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:fig:Catmull_Clark"

\end_inset

.c.) may produce similar results to those obtained with Catmull-Clark (see
 figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:fig:Catmull_Clark"

\end_inset

.b.), whose models have average equal triangles.
 The one obtained with the Laplacian smoothing is shown in panel (c), (d)
 and the curvature modified versions are in (e) and (f).
 As can be observed, different versions of the original sketch can be obtained
 by parameterizing a single model value, a great advantage of the presented
 method.
 Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:fig:camello_enhanced"

\end_inset

 shows the generation of different versions of a camel according to the
 
\begin_inset Formula $\lambda$
\end_inset

 parameter.
 In the top row the shape inflation results are shown.
 As 
\begin_inset Formula $\lambda$
\end_inset

 becomes larger and negative, the resultant shape was inflated on the more
 convex parts, as shown in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:fig:Spectrum"

\end_inset

.
 The larger the 
\begin_inset Formula $\lambda$
\end_inset

 parameter, the larger the model feature inflations.
 The bottom row of figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:fig:camello_enhanced"

\end_inset

 shows the use of weighted vertex groups, specifying which areas will be
 inflated.
 On the left, the inflation of the camel legs produces an organic aspect,
 notice that the border is not distorted and smooth.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename resources/figs/camello_walk2.png
	lyxscale 40
	width 100text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "PAPER:fig:Animated_Camell"

\end_inset

The method is pose insensitive.
 The inflation for the different poses are similar in terms of shape.
 Top row: Original walk cycle camel model.
 Bottom row: Shape inflation with weight vertex group, 
\begin_inset Formula $\lambda=-400$
\end_inset

 and 
\begin_inset Formula $2$
\end_inset

 iterations.
 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The inflation of the silhouette's features is predictable and invariant
 under isometric transformations, like those classically used in some animations
 (see Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:fig:Animated_Camell"

\end_inset

).
 In this figure, the animation shows some camel poses during a walk.
 The inflation is performed at the neck and legs, as shown in the bottom
 left camel in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:fig:Animated_Camell"

\end_inset

.
 Local modifications produced by the pose interpolation or animation rigging
 practically do not affect the result.
 There is a clear difference despite the pose of the camel's legs.
 The inflation method allows a flesh-like shape in the original pattern
 produced by the artist, this is due to the mesh restricted diffusion process
 so that small local changes are treated without affecting the global solution.
 The method therefore is rotation invariant since it depends exclusively
 on the normal mesh field.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename resources/figs/sculpt_brush.pdf
	lyxscale 70
	height 30theight%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "PAPER:fig:Sculpt_Brush"

\end_inset

Top row: (a) Original camel leg, (b) Inflate Brush used on leg within blue
 circle, (c) Enhance Brush used on leg within red circle.
 Bottom row: (a) Original hand, (b) Inflate Brush used on fingers within
 blue circle, (c) Enhance Brush used on fingers within red circle.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename resources/figs/verts_per_second_sculpt.pdf
	lyxscale 50
	width 100col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "PAPER:fig:Performance-sculpt"

\end_inset

Performance of our dynamic Enhance Brush in terms of the sculpted vertices
 per second.
 Three models with 12K, 40K, 164K vertices used for sculpting in real time.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:fig:Sculpt_Brush"

\end_inset

 shows the use of the Enhance Brush for sculpting in real time.
 One pass was used with the brush, shown by the blue and red radius.
 In figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:fig:Sculpt_Brush"

\end_inset

.b the camel hoof shows the inflation intersection, which looks like two
 bubbles, a similar pattern that is observed on the fingers on the bottom
 row of the same figure.
 The silhouette inflation is observed in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:fig:Sculpt_Brush"

\end_inset

.c the main shape is retained together with either its finger or hoof details.
 Similar results can be obtained by using different brushes, however it
 would take several steps, while the Enhance Brush for shape inflation takes
 only a single step.
 For this reason, this new method can easily inflate organic features like
 muscles during the sculpting process.
 In figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:fig:Performance-sculpt"

\end_inset

 the Enhance Brush performance is illustrated.
 In this experiment three models with 12K, 40K and 164K vertices, were used.
 These models were sculpted with the Enhance Brush, each time the user selected
 a variable number of vertices for processing.
 The processing time for 800 vertices in the camel hoof (40k model) only
 took 0.1 seconds, for 2600 vertices in the leg and neck (model 40k) it took
 0.5 seconds.
 These times are suitable in real applications since an artist sculpts a
 model by parts and each part is represented by an average of about 1800
 vertices.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename resources/figs/monkey.pdf
	lyxscale 60
	width 100col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "PAPER:fig:(a)Monkey"

\end_inset

(a) Bottom row: Original Model.
 Top row: Original model scaled by 4.
 (b) Top and bottom row: inflated with Normalized-TQLBO 
\begin_inset Formula $\lambda=-50$
\end_inset

 from (a) respectively (c) Top and bottom row: inflated with TQLBO 
\begin_inset Formula $\lambda=-50$
\end_inset

 from (a) respectively.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Tests with the Laplacian operator (equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:eq:TQLBO_Simple_Matrix"

\end_inset

) and its normalized version (equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:eq:TQLBO-Normalized_Matrix"

\end_inset

), produce similar results if the triangles or quads that compose the mesh
 are about the same size.
 The normalized version is more stable and predictable because it is not
 divided by the area of the ring, which may be very small and cause numerical
 problems, as shown in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:fig:(a)Monkey"

\end_inset

.c bottom row.
 The shape inflation of the model with the normalized Laplacian operator
 results in a more regular pattern.
 The model can be deformed with a normalized version of TQLBO with large
 
\begin_inset Formula $\lambda$
\end_inset

 (
\begin_inset Formula $\lambda>400$
\end_inset

) that can intersect itself but without any peaks.
 Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:fig:(a)Monkey"

\end_inset

.c shows different results due to the quads' areas in the model.
 Quads with larger areas have smaller inflations (figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:fig:(a)Monkey"

\end_inset

.c skull), and smaller quads have larger inflations (figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:fig:(a)Monkey"

\end_inset

.c chin).
\end_layout

\begin_layout Section
Implementation
\begin_inset CommandInset label
LatexCommand label
name "PAPER:sec:Implementation"

\end_inset


\end_layout

\begin_layout Standard
The method was implemented as a modifier for modeling and brush for sculpting,
 on Blender software 
\begin_inset CommandInset citation
LatexCommand cite
key "blender"

\end_inset

 in C and C++ language programming.
 Working with Blender allowed the method to be tested interactively against
 other methods, such as Catmull-Clark, Weight Vertex Groups and Sculpting
 System.
\end_layout

\begin_layout Standard
To improve the performance, it was worked with the Blender mesh structure,
 visiting each triangle or quad and storing its corresponding index and
 the sum of the Laplacian weights of the ring in a list so that only two
 visits were required for the list of mesh faces and two times for the edge
 list, if the mesh was not closed.
 This drastically reduced calculations, enabling real-time processing.
 In the construction of the Laplacian matrix, several indices were locked
 at vertices, which had face areas or edge lengths with zero value that
 could cause spikes and bad results.
\end_layout

\begin_layout Standard
Under these conditions, the matrix of the equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:eq:TQLBO_Simple_Matrix"

\end_inset

 is sparse since the number of neighbors per vertex, corresponding to the
 number of data per row, is smaller compared to the total number of vertices
 in the mesh.
 To solve the linear system equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:eq:Lineal_System_with_wp"

\end_inset

 OpenNL 
\begin_inset CommandInset citation
LatexCommand cite
key "Buatois2007"

\end_inset

 was used, which is a a library for solving sparse linear systems.
\end_layout

\begin_layout Section
Conclusion and future work
\begin_inset CommandInset label
LatexCommand label
name "PAPER:sec:Conclusion-and-future"

\end_inset


\end_layout

\begin_layout Standard
This work presented an extension of the Laplace Beltrami operator for hybrid
 quad/triangle meshes that can be used in production environments and provides
 results similar to those obtained by working only with triangles or quads.
 This paper has introduced a new way to change silhouettes in a mesh for
 modeling or sculpting in a few steps by means of the curvature model modificati
on while preserving its overall shape.
 In addition, a new modeling method has also been presented and some possible
 applications have been illustrated.
 The method works properly with isometric transformations, opening the possibili
ty of introducing it to the process of animation.
\end_layout

\begin_layout Standard
We show that this tool may work in early modeling stages, when coarse models
 are used, allowing the shape generated by the Catmull-Clark subdivision
 surfaces to be modified and thereby avoiding edition of the vertices with
 a change of a single parameter.
\end_layout

\begin_layout Standard
Future work includes the analysis of theoretical relationships between the
 Catmull-Clark subdivision surfaces and the Laplacian smoothing since they
 can produce very similar results.
 
\end_layout

\begin_layout Section*
Acknowledgment
\end_layout

\begin_layout Standard
We would like to thank anonymous friends for their support of our research.
 
\end_layout

\begin_layout Standard
This work was supported in part by the Blender Foundation, Google Summer
 of Code program in 2012.
 
\end_layout

\begin_layout Standard
Livingstone elephant model is provided courtesy of INRIA and ISTI by the
 AIM@SHAPE Shape Repository.
 The Hand model is courtesy of the FarField Technology Ltd.
 The Camel model by Valera Ivanov is licensed under a Creative Commons Attributi
on 3.0 Unported License.
 Dinosaur and Monkey models are under public domain, courtesy of Blender
 Foundation.
\end_layout

\begin_layout Chapter
Mesh smoothing based on curvature flow operator in a diffusion equation
\begin_inset CommandInset label
LatexCommand label
name "sub:Laplacian-Smooth"

\end_inset


\end_layout

\begin_layout Standard
This work was accepted as part of the Blender 
\begin_inset CommandInset citation
LatexCommand cite
key "blender"

\end_inset

 software, an open source 3D application for modeling, rendering, composing,
 video editing and game creation.
 The work was supported by an awarded internship of the Google Summer of
 Code 2012 program, administered by Google Inc.
\end_layout

\begin_layout Section
Synopsis
\end_layout

\begin_layout Standard
Objects reconstructed from the real world contain undesirable noise in many
 computer graphics applications.
 A Mesh smoothing may remove that noise while still preserving the geometry
 and shape of the original model.
 This project aims to improve the mesh smoothing tools uses by Blender software,
 using curvature flow operator in a diffusion equation, allowing hybrid
 meshes composed of triangles and quads to be worked with, and using the
 Laplacian operator proposed by Pinzón and Romero 
\begin_inset CommandInset citation
LatexCommand cite
key "Pinzon2013"

\end_inset

.
\end_layout

\begin_layout Section
Benefits to Blender
\end_layout

\begin_layout Standard
This project proposes a new and robust mesh smoothing tool that improves
 the appearance of the surfaces of models.
 Usually, methods to scan computer graphics objects using the Kinect ZCam
 need to remove the noise present at the time of capture.
 This mesh smoothing method produces higher quality results without shrinkage,
 while the smoothing tool currently used collapses after several iterations.
\end_layout

\begin_layout Standard
This mesh smoothing method allows hard and soft constraints on the positions
 of the mesh points in order to maintain control over the shape, which facilitat
es the removal of noise generated during the sculpting, but without eliminating
 the desired details of the model.
 
\end_layout

\begin_layout Section
Deliverables 
\end_layout

\begin_layout Itemize
A new and robust mesh smoothing tool for Blender.
 
\end_layout

\begin_layout Itemize
Some documentation pages to be included in the manual.
 
\end_layout

\begin_layout Itemize
A technical document for developers to improve the method in the future.
 
\end_layout

\begin_layout Itemize
A tutorial explaining the use of the tool.
\end_layout

\begin_layout Section
Project Details 
\end_layout

\begin_layout Standard
The mesh smoothing algorithm was implemented as a diffusion equation for
 specific geometric structures.
 The project was divided in four parts:
\end_layout

\begin_layout Enumerate
Initialization of data and necessary structures.
\end_layout

\begin_layout Enumerate
Computation of the Laplacian Matrix.
\end_layout

\begin_layout Enumerate
Definition of the sparse linear system.
\end_layout

\begin_layout Enumerate
Solution of the sparse linear system, using a preconditioned bi-conjugated
 gradient numerical library.
\end_layout

\begin_layout Standard
Integration of the numerical library present in Blender to solve the sparse
 linear system
\end_layout

\begin_layout Standard
Generation of documentation and tutorials.
\end_layout

\begin_layout Section
Project Schedule
\end_layout

\begin_layout Itemize
3 weeks: Understanding the Blender source code and identifying the key points
 for the project.
\end_layout

\begin_layout Itemize
1 week: Definition of the data structures necessary to work with the Blender
 architecture.
\end_layout

\begin_layout Itemize
1 week: Implementation of the methods for the initial configuration of the
 smoothing algorithm.
 Implementation of the Laplacian matrix calculation.
\end_layout

\begin_layout Itemize
2 weeks: Integration of the numerical library.
\end_layout

\begin_layout Itemize
2 weeks: Formulation of the sparse linear system and implementation of the
 numerical method to solve it.
\end_layout

\begin_layout Itemize
3 weeks: Formulation and implementation of the graphical user interface.
\end_layout

\begin_layout Itemize
2 weeks: Testing the tool.
\end_layout

\begin_layout Itemize
3 weeks: Generation of the documentation and tutorials.
\end_layout

\begin_layout Section
Mesh Smoothing
\end_layout

\begin_layout Standard
A common way of attenuating noise in a polygonal mesh is by a diffusion
 process 
\begin_inset CommandInset citation
LatexCommand cite
key "Taubin1995,Desbrun1999"

\end_inset

.
 Laplacian smooth techniques allow a proper noise reduction of the mesh
 surface with minimal shape changes.
 The simple idea consists in moving the vertices in the Laplacian direction.
 When the cotangent version is used, the vertices are moved in the direction
 of the curvature flow.
 The complexity of the Laplacian smoothing can be linear in time and space
 with a fast convergence.
 The diffusion process can attenuate noise with only one iteration due the
 sparseness of the laplacian operator.
\end_layout

\begin_layout Standard
\noindent
\begin_inset Formula 
\begin{equation}
\frac{\partial V}{\partial t}=\lambda L\left(V\right)\label{eq:diffusion_process}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Where 
\begin_inset Formula $L$
\end_inset

 is the Laplacian matrix defined in equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:LaplacianMatrixForSmoothing"

\end_inset

 for meshes composed of triangles or quads with different sizes or irregular
 sampling and 
\begin_inset Formula $\lambda$
\end_inset

 is a scalar that controls the diffusion process, and smoothing factor.
 The equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:diffusion_process"

\end_inset

 can be linearly approximated using implicit integration with a Laplacian
 Operator version of TQLBO, the use of implicit integration makes the system
 more stable.
\end_layout

\begin_layout Standard
Computation of the Laplacian Matrix:
\end_layout

\begin_layout Enumerate
Definition of the sparse linear system.
\end_layout

\begin_layout Enumerate
Solution of the sparse linear system, using a preconditioned bi-conjugated
 gradient numerical library.
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\left(I-\lambda dtL\right)V^{n+1}=V^{n}\label{eq:LaplacianSmoothLinearEquationSystem}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The user may define the region of interest where the Laplacian smooth needs
 to be applied.
 For doing so, we add a diagonal matrix 
\begin_inset Formula $W_{p}$
\end_inset

 to equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:LaplacianSmoothLinearEquationSystem"

\end_inset

, where every element in the diagonal corresponds to the weight for every
 vertex.
\end_layout

\begin_layout Standard
\noindent
\align center

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\left(I-\lambda dtW_{p}L\right)V^{n+1}=V^{n}$
\end_inset


\end_layout

\begin_layout Standard
For non-closed meshes or meshes with holes, the curvature flow cannot be
 computed.
 For this reason, the system smoothes out the edges only in the direction
 of the diffusion process.
 The boundaries are treated as a one-dimensional curve, where the Laplacian
 is defined as the weighted difference between the vertex and the two immediate
 neighbors, ensuring the curve maintains its original form as much as possible.
 We define a Laplacian for mesh smoothing as a matrix equation.
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Formula 
\begin{equation}
L(i,j)=\begin{cases}
-\frac{1}{2A_{i}}w_{ij} & \mbox{if }j\in N(v_{i})\wedge v_{i}\notin\mbox{Boundary}\\
\frac{1}{2A_{i}}\underset{j\in N\left(v_{i}\right)}{\sum}w_{ij} & \mbox{if }i=j\wedge v_{i}\notin\mbox{Boundary}\\
-e_{ij} & \mbox{if }j\in N(v_{i})\wedge\left\{ v_{i},v_{j}\right\} \in\mbox{Boundary}\\
\frac{2}{E_{i}}\underset{j\in N\left(v_{i}\right)}{\sum}e_{ij} & \mbox{if }i=j\wedge\left\{ v_{i},v_{j}\right\} \in\mbox{Boundary}\\
0 & \mbox{otherwise}
\end{cases}\label{eq:LaplacianMatrixForSmoothing}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $L$
\end_inset

 is a 
\begin_inset Formula $n\times n$
\end_inset

 matrix, 
\begin_inset Formula $n$
\end_inset

 is the number of vertices of a given mesh 
\begin_inset Formula $M$
\end_inset

, 
\begin_inset Formula $w_{ij}$
\end_inset

 is the TQLBO defined in equation (
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:eq:TQLBO_wij"

\end_inset

), 
\begin_inset Formula $N\left(v_{i}\right)$
\end_inset

 is the 1-ring neighborhood which has a shared face with 
\begin_inset Formula $v_{i}$
\end_inset

, 
\begin_inset Formula $e_{ij}=\frac{1}{\left\Vert v_{i}-v_{j}\right\Vert }$
\end_inset

 is the inverse length of the edge between vertices 
\begin_inset Formula $\left\{ v_{i},v_{j}\right\} $
\end_inset

, 
\begin_inset Formula $E_{i}=\underset{j\in N\left(v_{i}\right)}{\sum}e_{ij}$
\end_inset

.
 
\begin_inset Formula $A_{i}$
\end_inset

 is the ring area around 
\begin_inset Formula $v_{i}$
\end_inset

.
\end_layout

\begin_layout Section
Results and Conclusions
\end_layout

\begin_layout Standard
The developed user interface can be seen in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Interface-LaplacianSmoothing"

\end_inset

.
 This tool allows the 
\begin_inset Formula $\lambda$
\end_inset

 parameters for inner points and boundaries to be set, as well as to configure
 soft constraints using weights defined by vertices in 
\begin_inset Quotes eld
\end_inset

Vertex Group
\begin_inset Quotes erd
\end_inset

 and also to set strong constraints by independently applying the algorithm
 in the axis X, Y or Z.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename resources/figs/Apinzonf_Diagram_Modifier_Panel.png

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Interface-LaplacianSmoothing"

\end_inset

Panel inside blender user interface of the Laplacian Smooth modifier tool.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The tool developed can set the 
\begin_inset Formula $\lambda dt$
\end_inset

 parameter of equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:LaplacianSmoothLinearEquationSystem"

\end_inset

.
 Using a small Lambda factor (
\begin_inset Formula $\lambda<1.0$
\end_inset

), noise can be removed without significantly affecting the geometry (see
 figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Factor-LaplacianSmoothing"

\end_inset

.b), while using a large Lambda factor (
\begin_inset Formula $\lambda>1.0$
\end_inset

) smoothed versions can be obtained at the cost of losing fine geometry
 details (see figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Factor-LaplacianSmoothing"

\end_inset

.c and 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Factor-LaplacianSmoothing"

\end_inset

.d).
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename resources/figs/LaplacianSmoothingFactor.pdf
	width 100text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Factor-LaplacianSmoothing"

\end_inset

Noise attenuation in face model with Laplacian smoothing tool using only
 one iteration and changing 
\begin_inset Formula $\lambda$
\end_inset

.
 (a) Original Model.
 (b) Smoothing 
\begin_inset Formula $\lambda=0.5$
\end_inset

.
 (c) Smoothing 
\begin_inset Formula $\lambda=2.5$
\end_inset

 (d) Smoothing with 
\begin_inset Formula $\lambda=5.0$
\end_inset

.
 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The user can smooth the boundaries by configuring the parameter 
\begin_inset Quotes eld
\end_inset


\shape slanted
Border
\shape default

\begin_inset Quotes erd
\end_inset

, seen in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Interface-LaplacianSmoothing"

\end_inset

.
 Boundaries are treated differently since there is no way to calculate the
 boundary curvature flow.
 For this reason the Lambda factor 
\begin_inset Quotes eld
\end_inset


\shape slanted
Border
\shape default

\begin_inset Quotes erd
\end_inset

 just smooths them.
 The change of this parameter and the results seen in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Border-LaplacianSmoothing"

\end_inset

, illustrate how the boundary inside the red circle is smoothed.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename resources/figs/LaplacianSmoothingBoundary.pdf
	width 100text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Border-LaplacianSmoothing"

\end_inset

 Smoothing boundary changing 
\begin_inset Formula $\lambda_{Border}$
\end_inset

 factor.
 (a) Original Model.
 (b) Smoothing 
\begin_inset Formula $\lambda_{Border}=1.0$
\end_inset

.
 (c) Smoothing 
\begin_inset Formula $\lambda_{Border}=2.5$
\end_inset

 (d) Smoothing with 
\begin_inset Formula $\lambda_{Border}=10.0$
\end_inset

.
 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The tool allows the user to add soft constraints using weights for each
 vertex, this allows regions of interest where you want to apply the algorithm
 to be defined.
 In figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:VertexGroup-LaplacianSmoothing"

\end_inset

.c, the red region corresponds to the desired region and figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:VertexGroup-LaplacianSmoothing"

\end_inset

.d stands for those smoothened vertices in the red region.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename resources/figs/LaplacianSmoothingVertecGroup.pdf
	lyxscale 50
	width 100text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:VertexGroup-LaplacianSmoothing"

\end_inset

Use of weights per vertex to constrain the effect of mesh smoothing.
 (a) Original Model.
 (b) Smoothing with 
\begin_inset Formula $\lambda=1.5$
\end_inset

 (c) red vertices 
\begin_inset Formula $weight=1.0$
\end_inset

, blue vertices 
\begin_inset Formula $weight=0.0$
\end_inset

.
 (d) Smoothing with 
\begin_inset Formula $\lambda=2.5$
\end_inset

.
 The red vertices were the only vertices smoothed.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
This module was developed as a tool for Blender software to remove noise
 in the most efficient way.
 The state-of-the-art methods remove noise only if the mesh is composed
 by triangles, in contrast, with the developed tool, artists can now remove
 the noise even if the mesh is composed of triangles and quadrangles.
\end_layout

\begin_layout Chapter
Mesh Editing with Laplacian Deform
\begin_inset CommandInset label
LatexCommand label
name "sub:Laplacian-Deform"

\end_inset


\end_layout

\begin_layout Standard
This work was accepted and completed for Blender 
\begin_inset CommandInset citation
LatexCommand cite
key "blender"

\end_inset

 software, which is an open source 3D application for modeling, animation,
 rendering, composing, video editing and game creation.
 In the Google Summer of Code 2013 program which was administered by Google
 Inc.
\end_layout

\begin_layout Section
Synopsis
\end_layout

\begin_layout Standard
The mesh editing is generally done with affine transformations.
 Blender3D offers some tools that can transform vertices, such as “proportional
 editing object mode” with which the transformation of some vertices is
 interpolated with the other vertices that are connected with the use of
 simple distance functions.
\end_layout

\begin_layout Standard
This project proposes to implement a method for mesh editing based on sketching
 lines defined by the user and preserving the geometric details of the surface.
\end_layout

\begin_layout Standard
This method captures the geometric details using differential coordinates
 representations.
 The differential coordinates captures the local geometric information (curvatur
e and direction) of the vertex based on its neighbors.
 This method allows you to retrieve the best possible original model after
 changing the positions of some vertices by using the differential coordinates
 of the original model.
\end_layout

\begin_layout Section
Benefits to Blender
\end_layout

\begin_layout Standard
This project proposes a new tool for Blender users that requires the preservatio
n of geometric details of the surface during modeling, transformation and
 definition of the shape keys of the mesh vertices.
\end_layout

\begin_layout Standard
The method will allow novice users to edit any polygon mesh preserving the
 surface details.
\end_layout

\begin_layout Standard
This method allows the user to define new shape keys in a faster and more
 intuitive way.
\end_layout

\begin_layout Section
Deliverables
\end_layout

\begin_layout Itemize
A new mesh editing tool for Blender.
 
\end_layout

\begin_layout Itemize
Some pages of documentation to be included in the manual 
\end_layout

\begin_layout Itemize
A technical document for developers to improve the method in the future.
 
\end_layout

\begin_layout Itemize
A tutorial explaining the use of the tool.
\end_layout

\begin_layout Section
Project Details
\end_layout

\begin_layout Standard
The project is divided into eight parts:
\end_layout

\begin_layout Enumerate
Calculate the differential coordinates.
 
\end_layout

\begin_layout Enumerate
Store the fixed vertices (Hard constraints).
 
\end_layout

\begin_layout Enumerate
Store positions of the edited vertices.
 
\end_layout

\begin_layout Enumerate
Store the most representative vertex to retrieve rotation of every differential
 coordinate.
\end_layout

\begin_layout Enumerate
Solve the initial solution – in least-squares sense.
 
\end_layout

\begin_layout Enumerate
Rotate the differential coordinates based on initial solution and the most
 representative vertex.
\end_layout

\begin_layout Enumerate
Reconstruct the surface – in least-squares sense.
 
\end_layout

\begin_layout Enumerate
Generation of the documentation and tutorials.
\end_layout

\begin_layout Section
Project Schedule
\end_layout

\begin_layout Itemize
2 Weeks: Calculate the differential coordinates.
\end_layout

\begin_layout Itemize
2 Weeks: Store the fixed vertices (Hard constraints).
\end_layout

\begin_layout Itemize
2 Weeks: Store positions of the edited vertices.
\end_layout

\begin_layout Itemize
2 Weeks: Compute initial solution.
\end_layout

\begin_layout Itemize
2 Weeks: Rotate differential coordinates.
\end_layout

\begin_layout Itemize
2 Weeks: Reconstruct the surface – in least-squares sense.
 
\end_layout

\begin_layout Itemize
1 Week: Testing the tool and Define and implement graphical user integration.
\end_layout

\begin_layout Itemize
2 Weeks: Generation of the documentation and tutorials.
\end_layout

\begin_layout Section
Laplacian Deform
\end_layout

\begin_layout Standard
The Laplacian deformation facilitates mesh visualization while preserving
 the geometric surface details.
 In this method the user defines a set of anchor vertices which serve to
 re-pose the mesh by translating some of them.
 The system keeps the anchor vertices in fixed positions and calculates
 the best possible locations of the other vertices so that the shape preserves
 the original geometric details.
 This work adapts the method proposed by Sorkine et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Sorkine2004"

\end_inset

 for mesh deformations by deleting the use of static vertices.
 The method has also been applied to hybrid meshes composed of triangles
 and quads, using the proposed TQLBO.
 In particular, the geometric details are captured using differential coordinate
s representations that contain the local geometric information (curvature
 and direction) of the vertex and its neighbors, as shown in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:DifferentialCoor"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename resources/figs/DifferentialCoordinates.pdf
	width 70col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:DifferentialCoor"

\end_inset

 Difference between 
\begin_inset Formula $v_{i}$
\end_inset

 and the center of mass of its neighbors 
\begin_inset Formula $v_{1},...,v$
\end_inset

.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\delta_{i}=\overset{m}{\underset{j=1}{\sum}}w_{ij}\left(v_{i}-v_{j}\right)\label{eq:DifferentialCoordinate}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $\delta_{i}$
\end_inset

 is the differential coordinate for vertex 
\begin_inset Formula $v_{i}$
\end_inset

.
 The 
\begin_inset Formula $v_{j}$
\end_inset

 are the immediate neighbors of 
\begin_inset Formula $v_{i}$
\end_inset

, and 
\begin_inset Formula $w_{ij}$
\end_inset

 is the weight between vertex 
\begin_inset Formula $v_{i}$
\end_inset

 and 
\begin_inset Formula $v_{j}$
\end_inset

 defined in equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:eq:TQLBO_wij"

\end_inset

 that is TQLBO.
\end_layout

\begin_layout Standard
Then the linear system for finding the new pose of a mesh is.
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\begin{bmatrix}w_{l}L\\
W_{c}
\end{bmatrix}X=\begin{bmatrix}\delta\\
W_{c}C
\end{bmatrix}\label{eq:LaplacianDefomSystem}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Where 
\begin_inset Formula $w_{l}$
\end_inset

 is the Laplacian Matrix weight 
\begin_inset Formula $L$
\end_inset

, and the Laplacian matrix 
\begin_inset Formula $L$
\end_inset

 was defined in equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:eq:TQLBO_Simple_Matrix"

\end_inset

 .
 
\begin_inset Formula $Wc$
\end_inset

 is a matrix that has only ones in the indices of anchor vertices.
 
\begin_inset Formula $C$
\end_inset

 is a vector with coordinates of anchor vertices after several transformations.
 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $\delta$
\end_inset

 are the differential coordinates defined in equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:DifferentialCoordinate"

\end_inset

.
\end_layout

\begin_layout Section
Testing Solvers 
\end_layout

\begin_layout Standard
For this project we chose a numerical solver to be included in the Blender
 software after an evaluation of the initial factorization of the Laplacian
 deformation system.
\end_layout

\begin_layout Standard
Linear equation system to solve
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Formula $\begin{bmatrix}w_{l}L\\
W_{c}
\end{bmatrix}X=\begin{bmatrix}\delta\\
W_{c}C
\end{bmatrix}$
\end_inset


\end_layout

\begin_layout Standard
Solving the sparse linear system
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Formula $Ax=b$
\end_inset


\end_layout

\begin_layout Standard
Where:
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Formula $A=\begin{bmatrix}w_{l}L\\
W_{c}
\end{bmatrix}$
\end_inset


\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Formula $x=V$
\end_inset


\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Formula $b=\begin{bmatrix}\delta\\
W_{c}C
\end{bmatrix}$
\end_inset


\end_layout

\begin_layout Subsection
Hardware Specification 
\end_layout

\begin_layout Itemize
Processor: AMD Quad-Core 2.40 GHz 
\end_layout

\begin_layout Itemize
RAM: 8.0 GB 
\end_layout

\begin_layout Itemize
OS: Windows 7 Professional 
\end_layout

\begin_layout Itemize
Graphics controller: NVIDIA Quadro FX 570
\end_layout

\begin_layout Subsection
Software Specification 
\end_layout

\begin_layout Description
CGAL Computational Geometry Algorithms Library 
\end_layout

\begin_layout Description
Graphite Research platform for computer graphics
\end_layout

\begin_layout Subsection
Numeric Solvers Used 
\end_layout

\begin_layout Description
CG: Conjugate gradient method.
 
\end_layout

\begin_layout Description
BICGSTAB: Biconjugate gradient stabilized method.
 
\end_layout

\begin_layout Description
GMRES: Generalized minimal residual method.
 
\end_layout

\begin_layout Description
SUPERLU: Sparse Direct Solver, LU decomposition with partial pivoting.
 
\end_layout

\begin_layout Description
TAUCS_LDLT: A library of sparse linear solvers with LDLT factorization.
 
\end_layout

\begin_layout Description
CHOLMOD: Supernodal sparse Cholesky factorization.
 
\end_layout

\begin_layout Standard
LU factorization is a numerical method that works with large, sparse, non-symmet
ric systems of linear equations 
\begin_inset CommandInset citation
LatexCommand cite
key "Levy2005"

\end_inset

.
 We chose the implementation of LU factorization in an OpenNL-SuperLU library
 because this method showed better performance in the computation of a solution
 for a Laplacian Deform linear system of equations presented in equation
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:LaplacianDefomSystem"

\end_inset

 which can be seen in the table and plots 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:TimeVsSolvers"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Plot-IniFactor"

\end_inset

.
 OpenNL SuperLU can function with the Graphics Unit Processor GPU in order
 to exploit the capacity of GPU to be able to work with parallel structures,
 faster than a traditional CPU.
\end_layout

\begin_layout Standard
\begin_inset Float table
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="8">
<features rotate="0" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Model
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Vertices
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
CG
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
BICGSTAB
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
GMRES
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
SUPERLU
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
TAUCS
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
CHOLMOD
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Cross
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
24
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.05
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.05
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.04
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.04
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.05
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.05
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
King
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
538
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.83
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.63
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.71
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.61
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.68
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.79
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
YModel
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4770
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
19.60
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
16.44
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
16.93
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
16.06
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
16.88
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
17.95
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Man
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10002
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
33.43
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
27.76
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
29.91
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
28.54
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
29.53
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
30.80
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Neptune
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
28052
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
133.97
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
136.46
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
136.39
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
133.21
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
142.87
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
142.76
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Armadillo
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
34594
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
194.48
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
174.88
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
175.80
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
169.92
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
181.70
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
183.49
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:TimeVsSolvers"

\end_inset

Vertices Vs Seconds, Laplacian Deform initial factorization performance.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename Data/Benchmark.pdf
	width 100text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Plot-IniFactor"

\end_inset

Plot of Vertices Vs Seconds, Initial factorization performance.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Results
\end_layout

\begin_layout Standard
The user interface for Blender software can be seen in figure 
\begin_inset CommandInset ref
LatexCommand eqref
reference "fig:Panel-LaplacianDeform"

\end_inset

.
 In this tool, the user defines the anchor vertices and, with the use of
 a vertex, groups the features offered by Blender.
 The user configures this name in the field 
\shape slanted
Anchors Vertex Group
\shape default
.
 The 
\shape slanted
Bind
\shape default
 option initiates the system and captures the geometry details in the form
 of differential coordinates and computes the factorization of the linear
 system, after that the system is ready to pose meshes in a real-time interactio
n session.
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename resources/figs/Apinzonf_Diagram_Deform_Modifier_Panel_01.png

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Panel-LaplacianDeform"

\end_inset

Panel inside Blender user interface of the Laplacian Deform modifier tool.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Figure 
\begin_inset CommandInset ref
LatexCommand eqref
reference "fig:Armadillo"

\end_inset

 shows the Laplacian Deformation applied to a model with 173K vertices,
 only anchor vertices were used and are represented in blue.
 When the user applies several transformations (location, rotation, scale)
 to these anchor-vertices, the system finds a solution and estimates the
 position of the vertices (in yellow).
 This method works in real time and for doing so the matrix 
\begin_inset Formula $\begin{bmatrix}w_{l}L\\
W_{c}
\end{bmatrix}$
\end_inset

 in equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:LaplacianDefomSystem"

\end_inset

 is 
\begin_inset Formula $LU$
\end_inset

 decomposed only once, with LU factorization, when the system initiates.
 Once the matrix is factorized, the system can solve the unknown variables
 in the order of milliseconds.
 Results are improved by solving the system of equations several times,
 without LU factorization at every iteration, just the differential coordinates
 are adjusted since the differential coordinates can be rotated.
 Only four iterations were necessary for obtaining figure 
\begin_inset CommandInset ref
LatexCommand eqref
reference "fig:Armadillo"

\end_inset

 but the system finds proper solutions with only one iteration, when the
 angle of rotations are less than
\begin_inset Formula $\pi$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename resources/figs/Armadillo.pdf
	lyxscale 50
	width 100text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Armadillo"

\end_inset

Anchor vertices in blue.
 (a) Original Model, (b,c,d) new poses only change the anchor-vertices,
 the system finds positions for vertices in yellow.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Cactus"

\end_inset

 shows a comparison after making a single transformation that rotates the
 parts in blue 
\begin_inset Formula $70º$
\end_inset

 to the right.
 Results using a bicubic interpolation are shown in 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Cactus"

\end_inset

.b observe how the main trunk loses its shape when rotated.
 The propagation of changes made by the Laplacian deformation (figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Cactus"

\end_inset

.c) for the same transformation, shows better results.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename resources/figs/cactus.pdf
	lyxscale 50
	width 100text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Cactus"

\end_inset

(a) Original cactus model.
 (b) Blue segments are rotated 70º to the right and afterwards a basic interpola
tion is applied to the parts in yellow (c) Blue segments are rotated 70º
 to the right and afterwards a Laplacian deform tool is applied to the parts
 in yellow.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The Laplacian Deformation tool allows the user to change the model's pose
 while preserving the geometry details.
 In figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Horse"

\end_inset

.b and 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Horse"

\end_inset

.c observe the horse's new pose after five transformations and one head rotation.
 In figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Horse"

\end_inset

.b the shape and details are lost at every change using basic interpolation.
 In constrast, figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Horse"

\end_inset

..c illustrates how the new pose of the horse looks more natural, above all
 for the body and neck.
 This comparison indicates that the Laplacian Deform method allows any transform
ation to be applied without any loss of detail.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename resources/figs/horse.pdf
	lyxscale 60
	width 100text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Horse"

\end_inset

(a) Original Horse model.
 (b) The blue segments are translated and rotated and then basic interpolation
 is applied to the yellow parts (c) The blue segments are translated and
 rotated and then the Laplacian Deform tool is applied to the yellow parts.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Chapter
Skeleton Extraction
\end_layout

\begin_layout Standard
Part of this work was accepted and presented as a poster titled
\shape slanted
 Software para la Extracción del Esqueleto por Contracción y Suavizado
\shape default
 [Software for Skeleton Extraction by Contraction and Smoothing] at 7th
 International Seminar on Medical Image Processing and Analysis SIPAIM 2011.
 The conference was held on December 6-8 of 2011, in Bucaramanga, Colombia
 
\begin_inset CommandInset citation
LatexCommand cite
key "Pinzon2011"

\end_inset

, the poster thumbnail is shown in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:PosterSIPAIM2011"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename poster/SIPAIM2011/PosterSIPAIM2011.pdf
	lyxscale 50
	width 90text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:PosterSIPAIM2011"

\end_inset

Poster 
\shape slanted
Software para la Extracción del Esqueleto por Contracción y Suavizado 
\shape default
[Software for Skeleton Extraction by Contraction and Smoothing] presented
 at the 7th International Seminar on Medical Image Processing and Analysis
 SIPAIM 2011.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Part of this work was accepted and presented as a poster titled
\shape slanted
 Análisis Experimental de la Extracción del Esqueleto por Contracción con
 Suavizado Laplaciano
\shape default
 [Experimental Analysis of Skeleton Extraction by Contraction and Laplacian
 Smoothing] at the 6th International Seminar on Medical Image Processing
 and Analysis SIPAIM 2010.
 The conference was held on December 1-4 of 2010, in the city of Bogotá,
 Colombia 
\begin_inset CommandInset citation
LatexCommand cite
key "Pinzon2010"

\end_inset

, the poster thumbnail is shown in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:PosterSIPAIM2010"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename poster/SIPAIM2010/FINAL/PosteraA0-150dpi.pdf
	lyxscale 50
	width 90text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:PosterSIPAIM2010"

\end_inset

Poster 
\shape slanted
Análisis Experimental de la Extracción del Esqueleto por Contracción con
 Suavizado Laplaciano 
\shape default
[Experimental Analysis of Skeleton Extraction by Contraction and Laplacian
 Smoothing] presented at the 6th International Seminar on Medical Image
 Processing and Analysis SIPAIM 2010.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Background
\end_layout

\begin_layout Standard
Skeleton extraction not only reduces the dimensionality but also represents
 a three-dimensional object as a uni-dimensional structure 
\begin_inset CommandInset citation
LatexCommand cite
key "Cornea2007"

\end_inset

.
\end_layout

\begin_layout Standard
Skeleton extraction uses the natural shrink produced by Laplacian smoothing
 
\begin_inset CommandInset citation
LatexCommand cite
key "Meyer2003"

\end_inset

, to iteratively contract the mesh until the volume inside the surface is
 about zero (see figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:MeshContracted"

\end_inset

).
 This method stretches the mesh to guarantee that the object preserves,
 as much as possible, the original topology constraint 
\begin_inset CommandInset citation
LatexCommand cite
key "Au2008"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename resources/figs/contraccion.png
	lyxscale 30
	width 100text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:MeshContracted"

\end_inset

From left to right iterative mesh contraction.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The Laplacian smooth process moves the vertices in the direction of the
 Laplacian.
 If the cotangent Laplacian operator is used, the vertices move in the direction
 of minimal surface 
\begin_inset CommandInset citation
LatexCommand cite
key "Pinkall1993"

\end_inset

 following the curvature flow of the mesh surface.
\end_layout

\begin_layout Standard
Au et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Au2008"

\end_inset

 propose the next system of equations to iteratively contract the mesh until
 the volume is zero and a skeleton appears.
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\left[\begin{array}{c}
W_{L}L\\
W_{H}
\end{array}\right]X_{t+1}=\left[\begin{array}{c}
0\\
W_{H}X_{t}
\end{array}\right]\label{eq:SkeletonExtraction}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $L$
\end_inset

 is the Laplacian matrix described in equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "PAPER:eq:TQLBO_Simple_Matrix"

\end_inset

, 
\begin_inset Formula $W_{L}$
\end_inset

 is the smoothing factor and 
\begin_inset Formula $W_{H}$
\end_inset

 is the attraction constraint factor.
\end_layout

\begin_layout Standard
\begin_inset Formula $W_{L}$
\end_inset

 and 
\begin_inset Formula $W_{H}$
\end_inset

 change at every iteration.
 The contraction and smoothing constraint 
\begin_inset Formula $W_{L}^{t+1}=S_{L}W_{L}^{t}$
\end_inset

 with 
\begin_inset Formula $S_{L}=2.0$
\end_inset

.
 The attraction constraint 
\begin_inset Formula $W_{H,i}^{t+1}=W_{H,i}^{0}\sqrt{\frac{A_{i}^{0}}{A_{i}^{t}}}$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Formula $A_{i}^{t}$
\end_inset

 y 
\begin_inset Formula $A_{i}^{0}$
\end_inset

 are the current area and initial area of the ring surrounding 
\begin_inset Formula $x_{i}$
\end_inset

.
\end_layout

\begin_layout Section
Contribution
\end_layout

\begin_layout Standard
This work proposes an additional constraint: it seeks to move the vertices
 along a normal line.
 This constraint eliminates the need to adjust the final skeleton, taking
 each skeleton node and moving it to the center of the local mesh region.
 
\end_layout

\begin_layout Standard
The basic idea is to move the vertices along a normal line, estimated at
 every vertex, based on the average of the normals of the faces.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename resources/figs/LineConstraintSkeleton.pdf
	lyxscale 200
	width 100text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:LineConstraint"

\end_inset

Left: The vertex 
\begin_inset Formula $x_{i}$
\end_inset

 moves along the line constraint.
 Right: the distance of vertex 
\begin_inset Formula $x_{i}$
\end_inset

 to plane 1 and plane 2 when the position in every iteration changes.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
This line can be seen as an intersection of two planes (see figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:LineConstraint"

\end_inset

) created with the information of the vertex 
\begin_inset Formula $x_{i}$
\end_inset

, the normal 
\begin_inset Formula $\overrightarrow{\mathbf{n}_{i}}$
\end_inset

 and neighbors 
\begin_inset Formula $x_{j}$
\end_inset

 of 
\begin_inset Formula $x_{i}$
\end_inset

.
 
\end_layout

\begin_layout Standard
The plane equation.
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Formula $a\mathbf{x}+b_{0}\mathbf{y}+c_{0}\mathbf{z}+d_{0}=0$
\end_inset


\end_layout

\begin_layout Standard
There are various methods that build a plane equation using three non-collinear
 points.
 These three points were herein chosen using the vertex 
\begin_inset Formula $x_{i}$
\end_inset

, the normal 
\begin_inset Formula $\overrightarrow{\mathbf{n}_{i}}$
\end_inset

 and neighbors 
\begin_inset Formula $x_{j}$
\end_inset

 of 
\begin_inset Formula $x_{i}$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Formula $P_{1}=x_{i}$
\end_inset

, 
\begin_inset Formula $P_{2}=x_{j}$
\end_inset

 when 
\begin_inset Formula $x_{j}\in Neighbors\left(x_{i}\right)$
\end_inset

 and 
\begin_inset Formula $P_{3}=P_{1}-\overrightarrow{\mathbf{n}_{i}}$
\end_inset

.
\end_layout

\begin_layout Standard
An equation plane only requires three non-collinear points
\begin_inset Formula $\left\{ P_{1},P_{2},P_{3}\right\} $
\end_inset

 and we can solve the next system of equations to find the 
\begin_inset Formula $a,b,c$
\end_inset

 variables.
 
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Formula $\begin{array}{c}
ax_{1}+by_{1}+cz_{1}+d=0\\
ax_{2}+by_{2}+cz_{2}+d=0\\
ax_{3}+by_{3}+cz_{3}+d=0
\end{array}$
\end_inset


\end_layout

\begin_layout Standard
The distance of point 
\begin_inset Formula $P_{0}=\{x_{0},y_{0},z_{0}\}$
\end_inset

 to a plane 
\begin_inset Formula $\Pi=a\mathbf{x}+b_{0}\mathbf{y}+c_{0}\mathbf{z}+d_{0}$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\left|\Pi-P_{0}\right|=\frac{\left|ax_{0}+by_{0}+cz_{0}+d\right|}{\sqrt{a^{2}+b^{2}+c^{2}}}\label{eq:Plane_distance_equation}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
In the equation above, every point 
\begin_inset Formula $P_{0}=\{x_{0},y_{0},z_{0}\}$
\end_inset

 that belongs to the plane exists when equation (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:Plane_distance_equation"

\end_inset

) is null.
 If the point 
\begin_inset Formula $P_{0}$
\end_inset

 is not in the plane, the value of the plane equation (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:Plane_distance_equation"

\end_inset

) changes, and the absolute value is increased if 
\begin_inset Formula $P_{0}$
\end_inset

 is far from the plane.
 Let us use this simple relationship to build a valid constraint that can
 be put in the form of the linear equation 
\begin_inset Formula $Ax=B$
\end_inset

.
 Where 
\begin_inset Formula $A$
\end_inset

 is the matrix with values 
\begin_inset Formula $\begin{vmatrix}a & b & c\end{vmatrix}$
\end_inset

 the 
\begin_inset Formula $x$
\end_inset

 value corresponds to every vertex in mesh 
\begin_inset Formula $\{x_{0},y_{0},z_{0}\}$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

 stands for the 
\begin_inset Formula $d$
\end_inset

 value of the plane equation.
 Provided that the linear system presented in equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:SkeletonExtraction"

\end_inset

 has many solutions, the system solves it in the least-squares sense.
 With the new constraint, the system then tries to minimize the distance
 between the new vertex positions and the two planes.
 
\end_layout

\begin_layout Standard
The new system of equations proposed
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\left[\begin{array}{c}
W_{L}L\\
W_{H}\\
W_{D}\Pi_{1}\\
W_{D}\Pi_{2}
\end{array}\right]X_{t+1}=\left[\begin{array}{c}
0\\
W_{H}X_{t}\\
-D_{1}\\
-D_{2}
\end{array}\right]\label{eq:SkeletonExtractionDistance}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $W_{D}$
\end_inset

 is the weight for 
\begin_inset Formula $\Pi_{1}$
\end_inset

 and 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $\Pi_{2}$
\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
 constraints, which forces the vertices to move along the normal line of
 every vertex.
 
\begin_inset Formula $\Pi_{1}$
\end_inset

 and 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $\Pi_{2}$
\end_inset

 are matrix that contain 
\begin_inset Formula $a,b,c$
\end_inset

 values of the equation of the plane for every vertex.
 
\begin_inset Formula $D_{1}$
\end_inset

 and 
\begin_inset Formula $D_{2}$
\end_inset

 are the vectors with 
\begin_inset Formula $d$
\end_inset

 values of the equations of the planes for every vertex.
\end_layout

\begin_layout Section
Results and Conclusions
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename resources/figs/Skeletonizer_1.pdf
	width 100text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Skeletonizer-interface"

\end_inset

sjSkeletonizer interface.
 (a) Open and display mesh.
 (b) Mesh contracted after 4 iterations.
 (c) Skeleton obtained after surface simplification.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
As a result of this work, the software
\shape slanted
 sjSkeletonizer
\shape default
 
\begin_inset CommandInset citation
LatexCommand cite
key "Pinzon2012"

\end_inset

 permits the processing, visualization and extraction of the skeleton from
 polygonal hybrid meshes composed of triangles and quads.
 In figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Skeletonizer-interface"

\end_inset

, the software interface can be observed.
 The sjSkeletonizer software allows meshes in an interactive viewer to be
 opened and displayed.
 This software contracts a mesh with the use of two different Laplacian
 operators: the cotangent operator and umbrella operator, where the user
 can customize the number of iterations.
 The software allows a user to visualize the original mesh and contract
 mesh after a particular number of iterations (figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Skeletonizer-interface"

\end_inset

.b).
 In the final step of the process, the software simplifies the mesh (figure
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Skeletonizer-interface"

\end_inset

.c) using the same method proposed by Au et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Au2008"

\end_inset

 that consists of a modified version of quadric error metrics by Garland
 et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Garland1997"

\end_inset

 .
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename resources/figs/poses.png
	width 100text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Skeleton-extraction-poses"

\end_inset

 Model with different poses and skeleton obtained with our skeleton extraction
 software.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Skeleton-extractedModels"

\end_inset

 shows the skeleton extracted from different models using our method.
 Every skeleton accurately represents the topology and geometry of the original
 meshes.
 The extracted skeletons are homotopic to the original shapes.
 Our method also allows the skeleton to be simplified to the user's requirement
 in order to guarantee that every node in the skeleton closely represents
 every core part of the original model.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename resources/figs/Skeletonizer_2.pdf
	lyxscale 50
	width 100text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Skeleton-extractedModels"

\end_inset

Skeleton extracted from different models.
 (a) Dog model (b) Character model.
 (c) Person model.
 (d) Clay model.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The method proposed is robust under isometric transformations ( figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Skeleton-extraction-poses"

\end_inset

) so that if some global transformations, such as rotations of central parts
 of the mesh, are made, the extracted skeletons will be similar because
 the Laplacian operator properties are invariant under rotations.
 The figure shows similar skeletons for different poses of the same model,
 these skeletons show identical branching structure.
\end_layout

\begin_layout Chapter
Conclusion 
\begin_inset CommandInset label
LatexCommand label
name "sec:Conclusion-and-future"

\end_inset


\end_layout

\begin_layout Standard
This work presented a novel extension of the Laplace Beltrami operator for
 hybrid quad/triangle meshes, and the successful application of such principles
 in different types of problems in computer geometric modelling like smoothing,
 enhancing, sculpting, deformation, reposing and skeleton extraction.
\end_layout

\begin_layout Standard
We have largely demonstrated that our method has good performance, stability
 and robustness of the extension proposed.
 This novel extension of the Laplace Beltrami operator was introduced in
 the computer modeling industry inside the Blender 3D computer graphics
 software, in order to facilitate artists who work with different tools
 developed using TQLBO, for any kinds of meshes, i.e., triangular meshes,
 quadrilateral meshes or hybrid meshes.
\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
bibfiles "bibliografia/listado_inicial,TQLBO-paper/template,D:/src/blender/GSoC/GSOC2013/bibliography_mesh_editing,SIBGRAPI2013/template"
options "bibtotoc,plain"

\end_inset


\end_layout

\end_body
\end_document
